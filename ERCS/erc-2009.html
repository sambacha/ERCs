<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Compliance Service | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Compliance Service | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-2009" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-2009" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Compliance Service</h1>
  </header>

  <div class="post-content">
    <h2 id="simple-summary">Simple Summary</h2>

<p>This EIP proposes a service for decentralized compliance checks for regulated tokens.</p>

<h2 id="actors">Actors</h2>

<h4 id="operator">Operator</h4>
<p>An account which has been approved by a token to update the tokens accumulated.</p>

<h4 id="token">Token</h4>
<p>An account, normally a smart contract, which uses the <code class="language-plaintext highlighter-rouge">Compliance Service</code> to check if the an action can be executed or not.</p>

<h4 id="token-holder">Token holder</h4>
<p>An account which is in possession of tokens and on for which the checks are made.</p>

<h2 id="abstract">Abstract</h2>

<p>A regulated token needs to comply with several legal requirements, especially <a href="https://en.wikipedia.org/wiki/Know_your_customer">KYC</a> and <a href="https://en.wikipedia.org/wiki/Money_laundering#Anti-money_laundering">AML</a>. If the necessary checks have to be made off-chain the token transfer becomes centralized. Further the transfer in this case takes longer to complete as it can not be done in one transaction, but requires a second confirmation step. The goal of this proposal is to make this second step unnecessary by providing a service for compliance checks.</p>

<h2 id="motivation">Motivation</h2>

<p>Currently there is no proposal on how to accomplish decentralized compliance checks. <a href="./eip-1462.md">ERC-1462</a> proposes a basic set of functions to check if <code class="language-plaintext highlighter-rouge">transfer</code>, <code class="language-plaintext highlighter-rouge">mint</code> and <code class="language-plaintext highlighter-rouge">burn</code> are allowed for a user, but not how those checks should be implemented. This EIP proposes a way to implement them fully on-chain while being generic enough to leave the actual implementation of the checks up to the implementers, as these may vary a lot between different tokens.</p>

<p>The proposed <code class="language-plaintext highlighter-rouge">Compliance Service</code> supports more than one token. Therefore it could be used by law-makers to maintain the compliance rules of regulated tokens in one smart contract. This smart contract could be used by all of the tokens that fall under this jurisdiction and ensure compliance with the current laws.</p>

<p>By having a standard for compliance checks third-party developers can use them to verify if token movements for a specific account are allowed and act accordingly.</p>

<h2 id="specification">Specification</h2>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">CompliantService</span> <span class="p">{</span>
    <span class="k">function</span> <span class="n">checkTransferAllowed</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">byte</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">checkTransferFromAllowed</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">byte</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">checkMintAllowed</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">byte</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">checkBurnAllowed</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">byte</span><span class="p">);</span>
    
    <span class="k">function</span> <span class="n">updateTransferAccumulated</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">updateMintAccumulated</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">updateBurnAccumulated</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">from</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    
    <span class="k">function</span> <span class="n">addToken</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">token</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">replaceToken</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="n">token</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">removeToken</span><span class="p">(</span><span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">isToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">token</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">getTokenId</span><span class="p">(</span><span class="kt">address</span> <span class="n">token</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bytes32</span><span class="p">);</span>
    
    <span class="k">function</span> <span class="n">authorizeAccumulatedOperator</span><span class="p">(</span><span class="kt">address</span> <span class="n">operator</span><span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">revokeAccumulatedOperator</span><span class="p">(</span><span class="kt">address</span> <span class="n">operator</span><span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">isAccumulatedOperatorFor</span><span class="p">(</span><span class="kt">address</span> <span class="n">operator</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="n">tokenId</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    
    <span class="k">event</span> <span class="n">TokenAdded</span><span class="p">(</span><span class="kt">bytes32</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">token</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TokenReplaced</span><span class="p">(</span><span class="kt">bytes32</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">previousAddress</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">newAddress</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TokenRemoved</span><span class="p">(</span><span class="kt">bytes32</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">AuthorizedAccumulatedOperator</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">operator</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">RevokedAccumulatedOperator</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">operator</span><span class="p">,</span> <span class="kt">bytes32</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="mandatory-checks">Mandatory checks</h3>

<p>The checks must be verified in their corresponding actions. The action must only be successful if the check return an <code class="language-plaintext highlighter-rouge">Allowed</code> status code. In any other case the functions must revert.</p>

<h3 id="status-codes">Status codes</h3>

<p>If an action is allowed <code class="language-plaintext highlighter-rouge">0x11</code> (Allowed) or an issuer-specific code with equivalent but more precise meaning must be returned. If the action is not allowed the status must be <code class="language-plaintext highlighter-rouge">0x10</code> (Disallowed) or an issuer-specific code with equivalent but more precise meaning.</p>

<h3 id="functions">Functions</h3>

<h4 id="checktransferallowed">checkTransferAllowed</h4>

<p>Checks if the <code class="language-plaintext highlighter-rouge">transfer</code> function is allowed to be executed with the given parameters.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>from</td>
      <td>The address of the payer, from whom the tokens are to be taken if executed</td>
    </tr>
    <tr>
      <td>to</td>
      <td>The address of the payee, to whom the tokens are to be transferred if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be transferred</td>
    </tr>
  </tbody>
</table>

<h4 id="checktransferfromallowed">checkTransferFromAllowed</h4>

<p>Checks if the <code class="language-plaintext highlighter-rouge">transferFrom</code> function is allowed to be executed with the given parameters.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>sender</td>
      <td>The address of the sender, who initiated the transaction</td>
    </tr>
    <tr>
      <td>from</td>
      <td>The address of the payer, from whom the tokens are to be taken if executed</td>
    </tr>
    <tr>
      <td>to</td>
      <td>The address of the payee, to whom the tokens are to be transferred if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be transferred</td>
    </tr>
  </tbody>
</table>

<h4 id="checkmintallowed">checkMintAllowed</h4>

<p>Checks if the <code class="language-plaintext highlighter-rouge">mint</code> function is allowed to be executed with the given parameters.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>to</td>
      <td>The address of the payee, to whom the tokens are to be given if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be minted</td>
    </tr>
  </tbody>
</table>

<h4 id="checkburnallowed">checkBurnAllowed</h4>

<p>Checks if the <code class="language-plaintext highlighter-rouge">burn</code> function is allowed to be executed with the given parameters.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>from</td>
      <td>The address of the payer, from whom the tokens are to be taken if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be burned</td>
    </tr>
  </tbody>
</table>

<h4 id="updatetransferaccumulated">updateTransferAccumulated</h4>

<p>Must be called in the same transaction as <code class="language-plaintext highlighter-rouge">transfer</code> or <code class="language-plaintext highlighter-rouge">transferFrom</code>. It must revert if the update violates any of the compliance rules. It is up to the implementer which specific logic is executed in the function.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>from</td>
      <td>The address of the payer, from whom the tokens are to be taken if executed</td>
    </tr>
    <tr>
      <td>to</td>
      <td>The address of the payee, to whom the tokens are to be transferred if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be transferred</td>
    </tr>
  </tbody>
</table>

<h4 id="updatemintaccumulated">updateMintAccumulated</h4>

<p>Must be called in the same transaction as <code class="language-plaintext highlighter-rouge">mint</code>. It must revert if the update violates any of the compliance rules. It is up to the implementer which specific logic is executed in the function.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>to</td>
      <td>The address of the payee, to whom the tokens are to be given if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be minted</td>
    </tr>
  </tbody>
</table>

<h4 id="updateburnaccumulated">updateBurnAccumulated</h4>

<p>Must be called in the same transaction as <code class="language-plaintext highlighter-rouge">burn</code>. It must revert if the update violates any of the compliance rules. It is up to the implementer which specific logic is executed in the function.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>from</td>
      <td>The address of the payer, from whom the tokens are to be taken if executed</td>
    </tr>
    <tr>
      <td>value</td>
      <td>The amount to be minted</td>
    </tr>
  </tbody>
</table>

<h4 id="addtoken">addToken</h4>

<p>Adds a token to the service, which allows the token to call the functions to update the accumulated. If an existing token id is used the function must revert. It is up to the implementer if adding a token should be restricted or not.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>token</td>
      <td>The address from which the update functions will be called</td>
    </tr>
  </tbody>
</table>

<h4 id="replacetoken">replaceToken</h4>

<p>Replaces the address of a added token with another one. It is up to the implementer if replacing a token should be restricted or not, but a token should be able to replace its own address.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>token</td>
      <td>The address from which the update functions will be called</td>
    </tr>
  </tbody>
</table>

<h4 id="removetoken">removeToken</h4>

<p>Removes a token from the service, which disallows the token to call the functions to update the accumulated. It is up to the implementer if removing a token should be restricted or not.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
  </tbody>
</table>

<h4 id="istoken">isToken</h4>

<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the address has been added to the service, <code class="language-plaintext highlighter-rouge">false</code> if not.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>token</td>
      <td>The address which should be checked</td>
    </tr>
  </tbody>
</table>

<h4 id="gettokenid">getTokenId</h4>

<p>Returns the token id of a token. If the token has not been added to the service, ‘0’ must be returned.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>token</td>
      <td>The address which token id should be returned</td>
    </tr>
  </tbody>
</table>

<h4 id="authorizeaccumulatedoperator">authorizeAccumulatedOperator</h4>

<p>Approves an operator to update accumulated on behalf of the token id of msg.sender.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>operator</td>
      <td>The address to be approved as operator of accumulated updates</td>
    </tr>
  </tbody>
</table>

<h4 id="revokeaccumulatedoperator">revokeAccumulatedOperator</h4>

<p>Revokes the approval to update accumulated on behalf the token id the token id ofof msg.sender.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>operator</td>
      <td>The address to be revoked as operator of accumulated updates</td>
    </tr>
  </tbody>
</table>

<h4 id="isaccumulatedoperatorfor">isAccumulatedOperatorFor</h4>

<p>Retrieves if an operator is approved to create holds on behalf of <code class="language-plaintext highlighter-rouge">tokenId</code>.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>operator</td>
      <td>The address which is operator of updating the accumulated</td>
    </tr>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
  </tbody>
</table>

<h3 id="events">Events</h3>

<h4 id="tokenadded">TokenAdded</h4>

<p>Must be emitted after a token has been added.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>token</td>
      <td>The address from which the update functions will be called</td>
    </tr>
  </tbody>
</table>

<h4 id="tokenreplaced">TokenReplaced</h4>

<p>Must be emitted after the address of a token has been replaced.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
    <tr>
      <td>previousAddress</td>
      <td>The previous address which was used before</td>
    </tr>
    <tr>
      <td>newAddress</td>
      <td>The address which will be used from now on</td>
    </tr>
  </tbody>
</table>

<h4 id="tokenremoved">TokenRemoved</h4>

<p>Must be emitted after the a token has been removed.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>tokenId</td>
      <td>The unique ID which identifies a token</td>
    </tr>
  </tbody>
</table>

<h4 id="authorizedaccumulatedoperator">AuthorizedAccumulatedOperator</h4>

<p>Emitted when an operator has been approved to update the accumulated on behalf of a token.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>operator</td>
      <td>The address which is operator of updating the accumulated</td>
    </tr>
    <tr>
      <td>tokenId</td>
      <td>Token id on which behalf updates of the accumulated will potentially be made</td>
    </tr>
  </tbody>
</table>

<h4 id="revokedholdoperator">RevokedHoldOperator</h4>

<p>Emitted when an operator has been revoked from updating the accumulated on behalf of a token.</p>

<table>
  <thead>
    <tr>
      <th>Parameter</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>operator</td>
      <td>The address which was operator of updating the accumulated</td>
    </tr>
    <tr>
      <td>tokenId</td>
      <td>Token id on which behalf updates of the accumulated could be made</td>
    </tr>
  </tbody>
</table>

<h2 id="rationale">Rationale</h2>

<p>The usage of a token id instead of the address has been chosen to give tokens the possibility to update their smart contracts and keeping all their associated accumulated. If the address would be used, a migration process would needed to be done after a smart contract update.</p>

<p>No event is emitted after updating the accumulated as those are always associated with a <code class="language-plaintext highlighter-rouge">transfer</code>, <code class="language-plaintext highlighter-rouge">mint</code> or <code class="language-plaintext highlighter-rouge">burn</code> of a token which already emits an event of itself.</p>

<p>While not requiring it, the naming of the functions <code class="language-plaintext highlighter-rouge">checkTransferAllowed</code>, <code class="language-plaintext highlighter-rouge">checkTransferFromAllowed</code>, <code class="language-plaintext highlighter-rouge">checkMintAllowed</code> and <code class="language-plaintext highlighter-rouge">checkBurnAllowed</code> was adopted from <a href="./eip-1462.md">ERC-1462</a>.</p>

<p>While not requiring it, the naming of the functions <code class="language-plaintext highlighter-rouge">authorizeAccumulatedOperator</code>, <code class="language-plaintext highlighter-rouge">revokeAccumulatedOperator</code> and <code class="language-plaintext highlighter-rouge">isAccumulatedOperatorFor</code> follows the naming convention of <a href="./eip-777.md">ERC-777</a>.</p>

<p>Localization is not part of this EIP, but <a href="./eip-1066.md">ERC-1066</a> and <a href="./eip-1444.md">ERC-1444</a> can be used together to achieve it.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>As the EIP is not using any existing EIP there are no backwards compatibilities to take into consideration.</p>

<h2 id="implementation">Implementation</h2>

<p>The GitHub repository <a href="https://github.com/IoBuilders/compliance-service">IoBuilders/compliance-service</a> contains the work in progress implementation.</p>

<h2 id="contributors">Contributors</h2>
<p>This proposal has been collaboratively implemented by <a href="https://adhara.io/">adhara.io</a> and <a href="https://io.builders/">io.builders</a>.</p>

<h2 id="copyright">Copyright</h2>
<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>


  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
