<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>BLS12-381 Deterministic Account Hierarchy | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="BLS12-381 Deterministic Account Hierarchy | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-2334" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-2334" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">BLS12-381 Deterministic Account Hierarchy</h1>
  </header>

  <div class="post-content">
    <h2 id="simple-summary">Simple Summary</h2>

<p>This EIP defines the purpose of a given key, or family thereof, within a tree of keys. When combined with <a href="./eip-2333.md">EIP-2333</a>, the combination of a seed and knowledge of the desired purpose of a key is sufficient to determine a key pair.</p>

<h2 id="abstract">Abstract</h2>

<p>A standard for allocating keys generated by <a href="./eip-2333.md">EIP-2333</a> to a specific purpose. It defines a <code class="language-plaintext highlighter-rouge">path</code> which is a string that parses into the indices to be used when traversing the tree of keys that <a href="./eip-2333.md">EIP-2333</a> generates.</p>

<h2 id="a-note-on-purpose">A note on purpose</h2>

<p>This specification is designed not only to be an Ethereum 2.0 standard, but one that is adopted by the wider community who have adopted <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/">BLS signatures over BLS12-381</a>. It is therefore important also to consider the needs of the wider industry along with those specific to Ethereum. As a part of these considerations, it is the intention of the author that this standard eventually migrate to a more neutral repository in the future.</p>

<h2 id="motivation">Motivation</h2>

<p>Ethereum 2.0 alongside many other projects will use BLS signatures over BLS12-381, an <a href="https://datatracker.ietf.org/doc/draft-irtf-cfrg-bls-signature/">IETF proposed standard</a>. This new scheme requires a new key derivation mechanism, which is established within <a href="./eip-2333.md">EIP-2333</a>. This new scheme is incompatible with the current form of this specification (<a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP44</a>) due to the: exclusive use of hardened keys, the increased number of keys per level, not using <a href="https://github.com/bitcoin/bips/blob/master/bip-0032.mediawiki">BIP32</a> for key derivation. It is therefore necessary to establish a new <em>path</em> for traversing the <a href="./eip-2333.md">EIP-2333</a> key-tree.</p>

<p>The path structure specified in this EIP aims to be more general than <a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP44</a> by not having UTXO-centric features <a href="https://github.com/ethereum/EIPs/issues/84#issuecomment-292324521">which gave rise to the 4 different types of wallet paths being used within Ethereum 1.0</a> and gave rise to (draft) <a href="./eip-600.md">EIP-600</a> &amp; <a href="./eip-601.md">EIP-601</a></p>

<h2 id="specification">Specification</h2>

<h3 id="path">Path</h3>

<p>The path traversed through the tree of keys is defined by integers (which indicate the sibling index) separated by <code class="language-plaintext highlighter-rouge">/</code> which denote ancestor relations. There are 4 levels (plus the master node) in the path and at least 4 (5 including the master node) MUST be used.</p>

<div class="language-text highlighter-rouge"><div class="highlight"><pre class="highlight"><code>m / purpose / coin_type /  account / use
</code></pre></div></div>

<h4 id="notation">Notation</h4>

<p>The notation used within the path is specified within the <a href="./eip-2333.md">EIP-2333</a>, but is summarized again below for convenience.</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">m</code> Denotes the master node (or root) of the tree</li>
  <li><code class="language-plaintext highlighter-rouge">/</code> Separates the tree into depths, thus <code class="language-plaintext highlighter-rouge">i / j</code> signifies that <code class="language-plaintext highlighter-rouge">j</code> is a child of <code class="language-plaintext highlighter-rouge">i</code></li>
</ul>

<h3 id="purpose">Purpose</h3>

<p>The <code class="language-plaintext highlighter-rouge">purpose</code> is set to <code class="language-plaintext highlighter-rouge">12381</code> which is the name of the new curve (BLS12-381). In order to be in compliance with this standard, the <a href="./eip-2333.md">EIP-2333</a> MUST be implemented as the KDF and therefore, the purpose <code class="language-plaintext highlighter-rouge">12381</code> MAY NOT be used unless this is the case.</p>

<h3 id="coin-type">Coin Type</h3>

<p>The <code class="language-plaintext highlighter-rouge">coin_type</code> here reflects the coin number for an individual coin thereby acting as a means of separating the keys used for different chains.</p>

<h3 id="account">Account</h3>

<p><code class="language-plaintext highlighter-rouge">account</code> is a field that provides the ability for a user to have distinct sets of keys for different purposes, if they so choose. This is the level at which different accounts for a single user SHOULD to be implemented.</p>

<h3 id="use">Use</h3>

<p>This level is designed to provide a set of related keys that can be used for any purpose. The idea being that a single account has many uses which are related yet should remain separate for security reasons. It is required to support this level in the tree, although, for many purposes it will remain <code class="language-plaintext highlighter-rouge">0</code>.</p>

<h3 id="eth2-specific-parameters">Eth2 Specific Parameters</h3>

<h4 id="coin-type-1">Coin type</h4>

<p>The coin type used for the BLS12-381 keys in Ethereum 2 is <code class="language-plaintext highlighter-rouge">3600</code>.</p>

<h4 id="validator-keys">Validator keys</h4>

<p>Each Eth2 validator has two keys, one for withdrawals and transfers (called the <em>withdrawal key</em>), and the other for performing their duties as a validator (henceforth referred to as the <em>signing key</em>).</p>

<p>The path for withdrawal keys is <code class="language-plaintext highlighter-rouge">m/12381/3600/i/0</code> where <code class="language-plaintext highlighter-rouge">i</code> indicates the <code class="language-plaintext highlighter-rouge">i</code>th set of validator keys.</p>

<p>The path for the signing key is <code class="language-plaintext highlighter-rouge">m/12381/3600/i/0/0</code> where again, <code class="language-plaintext highlighter-rouge">i</code> indicates the <code class="language-plaintext highlighter-rouge">i</code>th set of validator keys. Another way of phrasing this is that the signing key is the <code class="language-plaintext highlighter-rouge">0</code>th child of the associated withdrawal key for that validator.</p>

<p><strong>Note:</strong> If the above description of key paths is not feasible in a specific use case (eg. with secret-shared or custodial validators), then the affected keys may be omitted and derived via another means. Implementations of this EIP, must endeavour to use the appropriate keys for the given use case to the extent that is reasonably possible. (eg, in the case of custodial staking, the user making the deposits will follow this standard for their withdrawal keys which has no bearing on how the service provide derives the corresponding signing keys.)</p>

<h2 id="rationale">Rationale</h2>

<p><code class="language-plaintext highlighter-rouge">purpose</code>, <code class="language-plaintext highlighter-rouge">coin_type</code>, and <code class="language-plaintext highlighter-rouge">account</code> are widely-adopted terms as per <a href="https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki">BIP43</a> and <a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP44</a> and therefore reusing these terms and their associated meanings makes sense.</p>

<p>The purpose needs to be distinct from these standards as the KDF and path are not inter-compatible and <code class="language-plaintext highlighter-rouge">12381</code> is an obvious choice.</p>

<p><code class="language-plaintext highlighter-rouge">account</code> separates user activity into distinct categories thereby allowing users to separate their concerns however they desire.</p>

<p><code class="language-plaintext highlighter-rouge">use</code> will commonly be determined at the application level providing distinct keys for non-intersecting use cases.</p>

<h3 id="eth2-specific-parameters-1">Eth2 Specific Parameters</h3>

<p>A new coin type is chosen for Eth2 keys to help ensure a clean separation between Eth2 and Eth1 keys. Although the distinction between Eth1 ETH and Eth2 ETH is subtle, they are distinct entities and there are services which only distinguish between coins by their coin name (eg. <a href="./eip-2304.md">ENS’ multichain address resolution</a>). <code class="language-plaintext highlighter-rouge">3600</code> is chosen specifically because it is the square of the Eth1’s <code class="language-plaintext highlighter-rouge">coin_type</code> (<code class="language-plaintext highlighter-rouge">3600==60^2</code>) thereby signaling that it is second instantiation of Ether the currency.</p>

<p>The primary reason validators have separate signing and withdrawal keys is to allow for the different security concerns of actions within Eth2. The signing key is given to the validator client where it signs messages as per the requirements of being a validator, it is therefore a “hot key”. If this key is compromised, the worst that can happen (locally) is that a slashable message is signed, resulting in the validator being slashed and forcibly exited. The withdrawal key is only needed when a validator wishes to perform an action not related to validating and has access to the full funds at stake for that validator. The withdrawal key therefore has higher security concerns and should be handled as a “cold key”. By having the signing key be a child of the withdrawal key, secure storage of the withdrawal key is sufficient to recover the signing key should the need arise.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p><a href="https://github.com/bitcoin/bips/blob/master/bip-0043.mediawiki">BIP43</a> and <a href="https://github.com/bitcoin/bips/blob/master/bip-0044.mediawiki">BIP44</a> are the commonly used standards for this purpose within Ethereum 1.0, however they have not been <code class="language-plaintext highlighter-rouge">Accepted</code> as standards as yet. Due to the use of a new KDF within <a href="./eip-2333.md">EIP-2333</a>, a new path standard is required. This EIP implements this, with minor changes.</p>

<p><code class="language-plaintext highlighter-rouge">purpose</code> <code class="language-plaintext highlighter-rouge">12381</code> paths do not support hardened keys and therefore the <code class="language-plaintext highlighter-rouge">'</code> character is invalid.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
