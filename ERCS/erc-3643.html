<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>T-REX - Token for Regulated EXchanges | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="T-REX - Token for Regulated EXchanges | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-3643" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-3643" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">T-REX - Token for Regulated EXchanges</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>The T-REX token is an institutional grade security token standard. This standard provides a library of interfaces for the management and compliant transfer of security tokens, using an automated onchain validator system leveraging onchain identities for eligibility checks.</p>

<p>The standard defines several interfaces that are described hereunder:</p>

<ul>
  <li>Token</li>
  <li>Identity Registry</li>
  <li>Identity Registry Storage</li>
  <li>Compliance</li>
  <li>Trusted Issuers Registry</li>
  <li>Claim Topics Registry</li>
</ul>

<h2 id="motivation">Motivation</h2>

<p>The advent of blockchain technology has brought about a new era of efficiency, accessibility, and liquidity in the world of asset transfer. This is particularly evident in the realm of cryptocurrencies, where users can transfer token ownership peer-to-peer without intermediaries. However, when it comes to tokenized securities or security tokens, the situation is more complex due to the need for compliance with securities laws. These tokens cannot be permissionless like utility tokens; they must be permissioned to track ownership and ensure that only eligible investors can hold tokens.</p>

<p>The existing Ethereum protocol, while powerful and versatile, does not fully address the unique challenges posed by security tokens. There is a need for a standard that supports compliant issuance and management of permissioned tokens, suitable for representing a wide range of asset classes, including small businesses and real estate.</p>

<p>The proposed <a href="./eip-3643.md">ERC-3643</a> standard is motivated by this need. It aims to provide a comprehensive framework for managing the lifecycle of security tokens, from issuance to transfers between eligible investors, while enforcing compliance rules at every stage. The standard also supports additional features such as token pausing and freezing, which can be used to manage the token in response to regulatory requirements or changes in the status of the token or its holders.</p>

<p>Moreover, the standard is designed to work in conjunction with an on-chain Identity system, allowing for the validation of the identities and credentials of investors through signed attestations issued by trusted claim issuers. This ensures compliance with legal and regulatory requirements for the trading of security tokens.</p>

<p>In summary, the motivation behind the proposed standard is to bring the benefits of blockchain technology to the world of securities, while ensuring compliance with existing securities laws. It aims to provide a robust, flexible, and efficient framework for the issuance and management of security tokens, thereby accelerating the evolution of capital markets.</p>

<h2 id="specification">Specification</h2>

<p>The proposed standard has the following requirements:</p>

<ul>
  <li><strong>MUST</strong> be <a href="./eip-20.md">ERC-20</a> compatible.</li>
  <li><strong>MUST</strong> be used in combination with an onchain Identity system</li>
  <li><strong>MUST</strong> be able to apply any rule of compliance that is required by the regulator or by the token issuer (about the factors of eligibility of an identity or about the rules of the token itself)</li>
  <li><strong>MUST</strong> have a standard interface to pre-check if a transfer is going to pass or fail before sending it to the blockchain</li>
  <li><strong>MUST</strong> have a recovery system in case an investor loses access to his private key</li>
  <li><strong>MUST</strong> be able to freeze tokens on the wallet of investors if needed, partially or totally</li>
  <li><strong>MUST</strong> have the possibility to pause the token</li>
  <li><strong>MUST</strong> be able to mint and burn tokens</li>
  <li><strong>MUST</strong> define an Agent role and an Owner (token issuer) role</li>
  <li><strong>MUST</strong> be able to force transfers from an Agent wallet</li>
  <li><strong>MUST</strong> be able to issue transactions in batch (to save gas and to have all the transactions performed in the same block)</li>
</ul>

<p>While this standard is backwards compatible with ERC-20 and all ERC-20 functions can be called on an ERC-3643 token, the implementation of these functions differs due to the permissioned nature of ERC-3643. Each token transfer under this standard involves a compliance check to validate the transfer and the eligibility of the stakeholder’s identities.</p>

<h3 id="agent-role-interface">Agent Role Interface</h3>

<p>The standard defines an Agent role, which is crucial for managing access to various functions of the smart contracts. The interface for the Agent role is as follows:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IAgentRole</span> <span class="p">{</span>

  <span class="c1">// events
</span>  <span class="k">event</span> <span class="n">AgentAdded</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_agent</span><span class="p">);</span>
  <span class="k">event</span> <span class="n">AgentRemoved</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_agent</span><span class="p">);</span>
  
  <span class="c1">// functions
</span>  <span class="c1">// setters
</span>  <span class="k">function</span> <span class="n">addAgent</span><span class="p">(</span><span class="kt">address</span> <span class="n">_agent</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
  <span class="k">function</span> <span class="n">removeAgent</span><span class="p">(</span><span class="kt">address</span> <span class="n">_agent</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

  <span class="c1">// getters
</span>  <span class="k">function</span> <span class="n">isAgent</span><span class="p">(</span><span class="kt">address</span> <span class="n">_agent</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">IAgentRole</code> interface allows for the addition and removal of agents, as well as checking if an address is an agent. In this standard, it is the owner role, as defined by <a href="./eip-173.md">ERC-173</a>, that has the responsibility of appointing and removing agents. Any contract that fulfills the role of a Token contract or an Identity Registry within the context of this standard must be compatible with the <code class="language-plaintext highlighter-rouge">IAgentRole</code> interface.</p>

<h3 id="main-functions">Main functions</h3>

<h4 id="transfer">Transfer</h4>

<p>To be able to perform a transfer on T-REX you need to fulfill several conditions :</p>

<ul>
  <li>The sender <strong>MUST</strong> hold enough free balance (total balance - frozen tokens, if any)</li>
  <li>The receiver <strong>MUST</strong> be whitelisted on the Identity Registry and verified (hold the necessary claims on his onchain Identity)</li>
  <li>The sender’s wallet <strong>MUST NOT</strong> be frozen</li>
  <li>The receiver’s wallet <strong>MUST NOT</strong> be frozen</li>
  <li>The token <strong>MUST NOT</strong> be paused</li>
  <li>The transfer <strong>MUST</strong> respect all the rules of compliance defined in the Compliance smart contract (canTransfer needs to return TRUE)</li>
</ul>

<p>Here is an example of <code class="language-plaintext highlighter-rouge">transfer</code> function implementation :</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="nb">transfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">public</span> <span class="k">override</span> <span class="n">whenNotPaused</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="nb">require</span><span class="p">(</span><span class="o">!</span><span class="n">_frozen</span><span class="p">[</span><span class="n">_to</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">_frozen</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">],</span> <span class="s">"ERC-3643: Frozen wallet"</span><span class="p">);</span>
        <span class="nb">require</span><span class="p">(</span><span class="n">_amount</span> <span class="o">&lt;=</span> <span class="n">balanceOf</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">_frozenTokens</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">]),</span> <span class="s">"ERC-3643: Insufficient Balance"</span><span class="p">);</span>
        <span class="nb">require</span><span class="p">(</span> <span class="n">_tokenIdentityRegistry</span><span class="p">.</span><span class="n">isVerified</span><span class="p">(</span><span class="n">to</span><span class="p">),</span> <span class="s">"ERC-3643: Invalid identity"</span> <span class="p">);</span> 
        <span class="nb">require</span><span class="p">(</span> <span class="n">_tokenCompliance</span><span class="p">.</span><span class="n">canTransfer</span><span class="p">(</span><span class="n">from</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">amount</span><span class="p">),</span> <span class="s">"ERC-3643: Compliance failure"</span> <span class="p">);</span>
        <span class="n">_transfer</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">_to</span><span class="p">,</span> <span class="n">_amount</span><span class="p">);</span>
        <span class="n">_tokenCompliance</span><span class="p">.</span><span class="n">transferred</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">_to</span><span class="p">,</span> <span class="n">_amount</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>
</code></pre></div></div>

<p>The <code class="language-plaintext highlighter-rouge">transferFrom</code> function works the same way while the <code class="language-plaintext highlighter-rouge">mint</code> function and the <code class="language-plaintext highlighter-rouge">forcedTransfer</code> function only require the receiver to be whitelisted and verified on the Identity Registry (they bypass the compliance rules). The <code class="language-plaintext highlighter-rouge">burn</code> function bypasses all checks on eligibility.</p>

<h4 id="isverified">isVerified</h4>

<p>The <code class="language-plaintext highlighter-rouge">isVerified</code> function is called from within the transfer functions <code class="language-plaintext highlighter-rouge">transfer</code>, <code class="language-plaintext highlighter-rouge">transferFrom</code>, <code class="language-plaintext highlighter-rouge">mint</code> and 
<code class="language-plaintext highlighter-rouge">forcedTransfer</code> to instruct the <code class="language-plaintext highlighter-rouge">Identity Registry</code> to check if the receiver is a valid investor, i.e. if his 
wallet address is in the <code class="language-plaintext highlighter-rouge">Identity Registry</code> of the token, and if the <code class="language-plaintext highlighter-rouge">Identity</code>contract linked to his wallet 
contains the claims (see <a href="../assets/eip-3643/ONCHAINID/IERC735.sol">Claim Holder</a>) required in the <code class="language-plaintext highlighter-rouge">Claim Topics Registry</code> and 
if these claims are signed by an authorized Claim Issuer as required in the <code class="language-plaintext highlighter-rouge">Trusted Issuers Registry</code>.
If all the requirements are fulfilled, the <code class="language-plaintext highlighter-rouge">isVerified</code> function returns <code class="language-plaintext highlighter-rouge">TRUE</code>, otherwise it returns <code class="language-plaintext highlighter-rouge">FALSE</code>. An 
implementation of this function can be found on the T-REX repository of Tokeny.</p>

<h4 id="cantransfer">canTransfer</h4>

<p>The <code class="language-plaintext highlighter-rouge">canTransfer</code> function is also called from within transfer functions. This function checks if the transfer is compliant with global compliance rules applied to the token, in opposition with <code class="language-plaintext highlighter-rouge">isVerified</code> that only checks the eligibility of an investor to hold and receive tokens, the <code class="language-plaintext highlighter-rouge">canTransfer</code> function is looking at global compliance rules, e.g. check if the transfer is compliant in the case there is a fixed maximum number of token holders to respect (can be a limited number of holders per country as well), check if the transfer respects rules setting a maximum amount of tokens per investor, …
If all the requirements are fulfilled, the <code class="language-plaintext highlighter-rouge">canTransfer</code> function will return <code class="language-plaintext highlighter-rouge">TRUE</code> otherwise it will return 
<code class="language-plaintext highlighter-rouge">FALSE</code> and the transfer will not be allowed to happen. An implementation of this function can be found on the T-REX 
repository of Tokeny.</p>

<h4 id="other-functions">Other functions</h4>

<p>Description of other functions of the ERC-3643 can be found in the <code class="language-plaintext highlighter-rouge">interfaces</code> folder. An implementation of the 
ERC-3643 suite of smart contracts can be found on the T-REX repository of Tokeny.</p>

<h3 id="token-interface">Token interface</h3>

<p>ERC-3643 permissioned tokens build upon the standard ERC-20 structure, but with additional functions to ensure compliance in the transactions of the security tokens. The functions <code class="language-plaintext highlighter-rouge">transfer</code> and <code class="language-plaintext highlighter-rouge">transferFrom</code> are implemented in a conditional way, allowing them to proceed with a transfer only if the transaction is valid. The permissioned tokens are allowed to be transferred only to validated counterparties, in order to avoid tokens being held in wallets/Identity contracts of ineligible/unauthorized investors. The ERC-3643 standard also supports the recovery of security tokens in case an investor loses access to their wallet private key. A history of recovered tokens is maintained on the blockchain for transparency reasons.</p>

<p>ERC-3643 tokens implement a range of additional functions to enable the owner or their appointed agents to manage supply, transfer rules, lockups, and any other requirements in the management of a security. The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of appointing agents. Any contract that fulfills the role of a Token contract within the context of this standard must be compatible with the <code class="language-plaintext highlighter-rouge">IAgentRole</code> interface.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/IERC3643.sol">interfaces folder</a>.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IERC3643</span> <span class="k">is</span> <span class="n">IERC20</span> <span class="p">{</span>

   <span class="c1">// events
</span>    <span class="k">event</span> <span class="n">UpdatedTokenInformation</span><span class="p">(</span><span class="kt">string</span> <span class="n">_newName</span><span class="p">,</span> <span class="kt">string</span> <span class="n">_newSymbol</span><span class="p">,</span> <span class="kt">uint8</span> <span class="n">_newDecimals</span><span class="p">,</span> <span class="kt">string</span> <span class="n">_newVersion</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_newOnchainID</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityRegistryAdded</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_identityRegistry</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">ComplianceAdded</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_compliance</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">RecoverySuccess</span><span class="p">(</span><span class="kt">address</span> <span class="n">_lostWallet</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_newWallet</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_investorOnchainID</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">AddressFrozen</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">bool</span> <span class="k">indexed</span> <span class="n">_isFrozen</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">_owner</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TokensFrozen</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TokensUnfrozen</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">Paused</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">Unpaused</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">);</span>


    <span class="c1">// functions
</span>    <span class="c1">// getters
</span>    <span class="k">function</span> <span class="n">onchainID</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">version</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span> <span class="k">memory</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">identityRegistry</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IIdentityRegistry</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">compliance</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">ICompliance</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">paused</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">isFrozen</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">getFrozenTokens</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span><span class="p">);</span>

    <span class="c1">// setters
</span>    <span class="k">function</span> <span class="n">setName</span><span class="p">(</span><span class="kt">string</span> <span class="k">calldata</span> <span class="n">_name</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setSymbol</span><span class="p">(</span><span class="kt">string</span> <span class="k">calldata</span> <span class="n">_symbol</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setOnchainID</span><span class="p">(</span><span class="kt">address</span> <span class="n">_onchainID</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">pause</span><span class="p">()</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">unpause</span><span class="p">()</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setAddressFrozen</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">_freeze</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">freezePartialTokens</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">unfreezePartialTokens</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setIdentityRegistry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_identityRegistry</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setCompliance</span><span class="p">(</span><span class="kt">address</span> <span class="n">_compliance</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// transfer actions
</span>    <span class="k">function</span> <span class="n">forcedTransfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">_from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">mint</span><span class="p">(</span><span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">burn</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">recoveryAddress</span><span class="p">(</span><span class="kt">address</span> <span class="n">_lostWallet</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_newWallet</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_investorOnchainID</span><span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="c1">// batch functions
</span>    <span class="k">function</span> <span class="n">batchTransfer</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_toList</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchForcedTransfer</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_fromList</span><span class="p">,</span> <span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_toList</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchMint</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_toList</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchBurn</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_userAddresses</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchSetAddressFrozen</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_userAddresses</span><span class="p">,</span> <span class="kt">bool</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_freeze</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchFreezePartialTokens</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_userAddresses</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchUnfreezePartialTokens</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_userAddresses</span><span class="p">,</span> <span class="kt">uint256</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_amounts</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
<span class="p">}</span>

</code></pre></div></div>

<h3 id="identity-registry-interface">Identity Registry Interface</h3>

<p>The Identity Registry is linked to storage that contains a dynamic whitelist of identities. It establishes the link between a wallet address, an Identity smart contract, and a country code corresponding to the investor’s country of residence. This country code is set in accordance with the ISO-3166 standard. The Identity Registry also includes a function called <code class="language-plaintext highlighter-rouge">isVerified()</code>, which returns a status based on the validity of claims (as per the security token requirements) in the user’s Identity contract.</p>

<p>The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of appointing agents. Any contract that fulfills the role of an Identity Registry within the context of this standard must be compatible with the <code class="language-plaintext highlighter-rouge">IAgentRole</code> interface. The Identity Registry is managed by the agent wallet(s), meaning only the agent(s) can add or remove identities in the registry. Note that the agent role on the Identity Registry is set by the owner, therefore the owner could set themselves as the agent if they want to maintain full control. There is a specific identity registry for each security token.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/IIdentityRegistry.sol">interfaces folder</a>.</p>

<p>Note that <a href="../assets/eip-3643/ONCHAINID/IClaimIssuer.sol"><code class="language-plaintext highlighter-rouge">IClaimIssuer</code></a> and <a href="../assets/eip-3643/ONCHAINID/IIdentity.sol"><code class="language-plaintext highlighter-rouge">IIdentity</code></a> are needed in this interface as they are required for the Identity eligibility checks.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IIdentityRegistry</span> <span class="p">{</span>


    <span class="c1">// events
</span>    <span class="k">event</span> <span class="n">ClaimTopicsRegistrySet</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">claimTopicsRegistry</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityStorageSet</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">identityStorage</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TrustedIssuersRegistrySet</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">trustedIssuersRegistry</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityRegistered</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">identity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityRemoved</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">identity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityUpdated</span><span class="p">(</span><span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">oldIdentity</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">newIdentity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">CountryUpdated</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="kt">uint16</span> <span class="k">indexed</span> <span class="n">country</span><span class="p">);</span>


    <span class="c1">// functions
</span>    <span class="c1">// identity registry getters
</span>    <span class="k">function</span> <span class="n">identityStorage</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IIdentityRegistryStorage</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">issuersRegistry</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">ITrustedIssuersRegistry</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">topicsRegistry</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IClaimTopicsRegistry</span><span class="p">);</span>

    <span class="c1">//identity registry setters
</span>    <span class="k">function</span> <span class="n">setIdentityRegistryStorage</span><span class="p">(</span><span class="kt">address</span> <span class="n">_identityRegistryStorage</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setClaimTopicsRegistry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_claimTopicsRegistry</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">setTrustedIssuersRegistry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_trustedIssuersRegistry</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// registry actions
</span>    <span class="k">function</span> <span class="n">registerIdentity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="n">_identity</span><span class="p">,</span> <span class="kt">uint16</span> <span class="n">_country</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">deleteIdentity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">updateCountry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint16</span> <span class="n">_country</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">updateIdentity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="n">_identity</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">batchRegisterIdentity</span><span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_userAddresses</span><span class="p">,</span> <span class="n">IIdentity</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_identities</span><span class="p">,</span> <span class="kt">uint16</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_countries</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// registry consultation
</span>    <span class="k">function</span> <span class="n">contains</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">isVerified</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">identity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IIdentity</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">investorCountry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint16</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="identity-registry-storage-interface">Identity Registry Storage Interface</h3>

<p>The Identity Registry Storage stores the identity addresses of all the authorized investors in the security token(s) linked to the storage contract. These are all identities of investors who have been authorized to hold the token(s) after having gone through the appropriate KYC and eligibility checks. The Identity Registry Storage can be bound to one or several Identity Registry contract(s). The goal of the Identity Registry storage is to separate the Identity Registry functions and specifications from its storage. This way, it is possible to keep one single Identity Registry contract per token, with its own Trusted Issuers Registry and Claim Topics Registry, but with a shared whitelist of investors used by the <code class="language-plaintext highlighter-rouge">isVerifed()</code> function implemented in the Identity Registries to check the eligibility of the receiver in a transfer transaction.</p>

<p>The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of appointing agents(in this case through the <code class="language-plaintext highlighter-rouge">bindIdentityRegistry</code> function). Any contract that fulfills the role of an Identity Registry Storage within the context of this standard must be compatible with the <code class="language-plaintext highlighter-rouge">IAgentRole</code> interface. The Identity Registry Storage is managed by the agent addresses (i.e. the bound Identity Registries), meaning only the agent(s) can add or remove identities in the registry. Note that the agent role on the Identity Registry Storage is set by the owner, therefore the owner could set themselves as the agent if they want to modify the storage manually. Otherwise it is the bound Identity Registries that are using the agent role to write in the Identity Registry Storage.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/IIdentityRegistryStorage.sol">interfaces folder</a>.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IIdentityRegistryStorage</span> <span class="p">{</span>

    <span class="c1">//events
</span>    <span class="k">event</span> <span class="n">IdentityStored</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">identity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityUnstored</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">identity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityModified</span><span class="p">(</span><span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">oldIdentity</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="k">indexed</span> <span class="n">newIdentity</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">CountryModified</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">investorAddress</span><span class="p">,</span> <span class="kt">uint16</span> <span class="k">indexed</span> <span class="n">country</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityRegistryBound</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">identityRegistry</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">IdentityRegistryUnbound</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">identityRegistry</span><span class="p">);</span>

    <span class="c1">//functions
</span>    <span class="c1">// storage related functions
</span>    <span class="k">function</span> <span class="n">storedIdentity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IIdentity</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">storedInvestorCountry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint16</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">addIdentityToStorage</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="n">_identity</span><span class="p">,</span> <span class="kt">uint16</span> <span class="n">_country</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">removeIdentityFromStorage</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">modifyStoredInvestorCountry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="kt">uint16</span> <span class="n">_country</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">modifyStoredIdentity</span><span class="p">(</span><span class="kt">address</span> <span class="n">_userAddress</span><span class="p">,</span> <span class="n">IIdentity</span> <span class="n">_identity</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// role setter
</span>    <span class="k">function</span> <span class="n">bindIdentityRegistry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_identityRegistry</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">unbindIdentityRegistry</span><span class="p">(</span><span class="kt">address</span> <span class="n">_identityRegistry</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// getter for bound IdentityRegistry role
</span>    <span class="k">function</span> <span class="n">linkedIdentityRegistries</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="compliance-interface">Compliance Interface</h3>

<p>The Compliance contract is used to set the rules of the offering itself and ensures these rules are respected during the whole lifecycle of the token. For example, the Compliance contract will define the maximum amount of investors per country, the maximum amount of tokens per investor, and the accepted countries for the circulation of the token (using the country code corresponding to each investor in the Identity Registry). The Compliance smart contract can be either “tailor-made”, following the legal requirements of the token issuer, or can be deployed under a generic modular form, which can then add and remove external compliance <code class="language-plaintext highlighter-rouge">Modules</code> to fit the legal requirements of the token in the same way as a custom “tailor-made” contract would.</p>

<p>This contract is triggered at every transaction by the Token and returns <code class="language-plaintext highlighter-rouge">TRUE</code> if the transaction is compliant with the rules of the offering and <code class="language-plaintext highlighter-rouge">FALSE</code> otherwise.</p>

<p>The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of setting the Compliance parameters and binding the Compliance to a Token contract.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/ICompliance.sol">interfaces folder</a>.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">ICompliance</span> <span class="p">{</span>

    <span class="c1">// events
</span>    <span class="k">event</span> <span class="n">TokenBound</span><span class="p">(</span><span class="kt">address</span> <span class="n">_token</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TokenUnbound</span><span class="p">(</span><span class="kt">address</span> <span class="n">_token</span><span class="p">);</span>

    <span class="c1">// functions
</span>    <span class="c1">// initialization of the compliance contract
</span>    <span class="k">function</span> <span class="n">bindToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">_token</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">unbindToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">_token</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// check the parameters of the compliance contract
</span>    <span class="k">function</span> <span class="n">isTokenBound</span><span class="p">(</span><span class="kt">address</span> <span class="n">_token</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">getTokenBound</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>

    <span class="c1">// compliance check and state update
</span>    <span class="k">function</span> <span class="n">canTransfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">_from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">transferred</span><span class="p">(</span><span class="kt">address</span> <span class="n">_from</span><span class="p">,</span> <span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">created</span><span class="p">(</span><span class="kt">address</span> <span class="n">_to</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">destroyed</span><span class="p">(</span><span class="kt">address</span> <span class="n">_from</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_amount</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="trusted-issuers-registry-interface">Trusted Issuer’s Registry Interface</h3>

<p>The Trusted Issuer’s Registry stores the contract addresses (<a href="../assets/eip-3643/ONCHAINID/IClaimIssuer.sol">IClaimIssuer</a>) of all the trusted claim issuers for a specific security token. The Identity contract (<a href="../assets/eip-3643/ONCHAINID/IIdentity.sol">IIdentity</a>) of token owners (the investors) must have claims signed by the claim issuers stored in this smart contract in order to be able to hold the token.</p>

<p>The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of managing this registry as per their requirements. This includes the ability to add, remove, and update the list of Trusted Issuers.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/ITrustedIssuersRegistry.sol">interfaces folder</a>.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">ITrustedIssuersRegistry</span> <span class="p">{</span>

    <span class="c1">// events
</span>    <span class="k">event</span> <span class="n">TrustedIssuerAdded</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="k">indexed</span> <span class="n">trustedIssuer</span><span class="p">,</span> <span class="kt">uint</span><span class="p">[]</span> <span class="n">claimTopics</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">TrustedIssuerRemoved</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="k">indexed</span> <span class="n">trustedIssuer</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">ClaimTopicsUpdated</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="k">indexed</span> <span class="n">trustedIssuer</span><span class="p">,</span> <span class="kt">uint</span><span class="p">[]</span> <span class="n">claimTopics</span><span class="p">);</span>

    <span class="c1">// functions
</span>    <span class="c1">// setters
</span>    <span class="k">function</span> <span class="n">addTrustedIssuer</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="n">_trustedIssuer</span><span class="p">,</span> <span class="kt">uint</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_claimTopics</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">removeTrustedIssuer</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="n">_trustedIssuer</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">updateIssuerClaimTopics</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="n">_trustedIssuer</span><span class="p">,</span> <span class="kt">uint</span><span class="p">[]</span> <span class="k">calldata</span> <span class="n">_claimTopics</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// getters
</span>    <span class="k">function</span> <span class="n">getTrustedIssuers</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IClaimIssuer</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">isTrustedIssuer</span><span class="p">(</span><span class="kt">address</span> <span class="n">_issuer</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">getTrustedIssuerClaimTopics</span><span class="p">(</span><span class="n">IClaimIssuer</span> <span class="n">_trustedIssuer</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span><span class="p">(</span><span class="kt">uint</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">getTrustedIssuersForClaimTopic</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">claimTopic</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">IClaimIssuer</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>
    <span class="k">function</span> <span class="n">hasClaimTopic</span><span class="p">(</span><span class="kt">address</span> <span class="n">_issuer</span><span class="p">,</span> <span class="kt">uint</span> <span class="n">_claimTopic</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span><span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="claim-topics-registry-interface">Claim Topics Registry Interface</h3>

<p>The Claim Topics Registry stores all the trusted claim topics for the security token. The Identity contract (<a href="../assets/eip-3643/ONCHAINID/IIdentity.sol">IIdentity</a>) of token owners must contain claims of the claim topics stored in this smart contract.</p>

<p>The standard relies on ERC-173 to define contract ownership, with the owner having the responsibility of managing this registry as per their requirements. This includes the ability to add and remove required Claim Topics.</p>

<p>A detailed description of the functions can be found in the <a href="../assets/eip-3643/interfaces/IClaimTopicsRegistry.sol">interfaces folder</a>.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IClaimTopicsRegistry</span> <span class="p">{</span>

    <span class="c1">// events
</span>    <span class="k">event</span> <span class="n">ClaimTopicAdded</span><span class="p">(</span><span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">claimTopic</span><span class="p">);</span>
    <span class="k">event</span> <span class="n">ClaimTopicRemoved</span><span class="p">(</span><span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">claimTopic</span><span class="p">);</span>

    <span class="c1">// functions
</span>    <span class="c1">// setters
</span>    <span class="k">function</span> <span class="n">addClaimTopic</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_claimTopic</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
    <span class="k">function</span> <span class="n">removeClaimTopic</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_claimTopic</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="c1">// getter
</span>    <span class="k">function</span> <span class="n">getClaimTopics</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="rationale">Rationale</h2>

<h3 id="transfer-restrictions">Transfer Restrictions</h3>

<p>Transfers of securities can fail for a variety of reasons. This is in direct contrast to utility tokens, which generally only require the sender to have a sufficient balance. These conditions can be related to the status of an investor’s wallet, the identity of the sender and receiver of the securities (i.e., whether they have been through a KYC process, whether they are accredited or an affiliate of the issuer) or for reasons unrelated to the specific transfer but instead set at the token level (i.e., the token contract enforces a maximum number of investors or a cap on the percentage held by any single investor). For ERC-20 tokens, the <code class="language-plaintext highlighter-rouge">balanceOf</code> and <code class="language-plaintext highlighter-rouge">allowance</code> functions provide a way to check that a transfer is likely to succeed before executing the transfer, which can be executed both on-chain and off-chain. For tokens representing securities, the T-REX standard introduces a function <code class="language-plaintext highlighter-rouge">canTransfer</code> which provides a more general-purpose way to achieve this. I.e., when the reasons for failure are related to the compliance rules of the token and a function <code class="language-plaintext highlighter-rouge">isVerified</code> which allows checking the eligibility status of the identity of the investor. Transfers can also fail if the address of the sender and/or receiver is frozen, or if the free balance of the sender (total balance - frozen tokens) is lower than the amount to transfer. Ultimately, the transfer could be blocked if the token is <code class="language-plaintext highlighter-rouge">paused</code>.</p>

<h3 id="identity-management">Identity Management</h3>

<p>Security and compliance of transfers are enforced through the management of on-chain identities. These include:</p>

<ul>
  <li>Identity contract: A unique identifier for each investor, which is used to manage their identity and claims.</li>
  <li>Claim: Signed attestations issued by a trusted claim issuer that confirm certain attributes or qualifications of the token holders, such as their identity, location, investor status, or KYC/AML clearance.</li>
  <li>Identity Storage/Registry: A storage system for all Identity contracts and their associated wallets, which is used to 
verify the eligibility of investors during transfers.</li>
</ul>

<h3 id="token-lifecycle-management">Token Lifecycle Management</h3>

<p>The T-REX standard provides a comprehensive framework for managing the lifecycle of security tokens. This includes the issuance of tokens, transfers between eligible investors, and the enforcement of compliance rules at every stage of the token’s lifecycle. The standard also supports additional features such as token pausing and freezing, which can be used to manage the token in response to regulatory requirements or changes in the status of the token or its holders.</p>

<h3 id="additional-compliance-rules">Additional Compliance Rules</h3>

<p>The T-REX standard supports the implementation of additional compliance rules through modular compliance. These modules can be used to enforce a wide range of rules and restrictions, such as caps on the number of investors or the percentage of tokens held by a single investor, restrictions on transfers between certain types of investors, and more. This flexibility allows issuers to tailor the compliance rules of their tokens to their specific needs and regulatory environment.</p>

<h3 id="inclusion-of-agent-related-functions">Inclusion of Agent-Related Functions</h3>

<p>The inclusion of Agent-scoped functions within the standard interfaces is deliberate. The intent is to accommodate secure and adaptable token management practices that surpass the capabilities of EOA management. We envision scenarios where the agent role is fulfilled by automated systems or smart contracts, capable of programmatically executing operational functions like minting, burning, and freezing in response to specified criteria or regulatory triggers. For example, a smart contract might automatically burn tokens to align with redemption requests in an open-ended fund, or freeze tokens associated with wallets engaged in fraudulent activities.</p>

<p>Consequently, these functions are standardized to provide a uniform interface for various automated systems interacting with different ERC-3643 tokens, allowing for standardized tooling and interfaces that work across the entire ecosystem. This approach ensures that ERC-3643 remains flexible, future-proof, and capable of supporting a wide array of operational models.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>T-REX tokens should be backwards compatible with ERC-20 and ERC-173
and should be able to interact with a <a href="../assets/eip-3643/ONCHAINID/IERC735.sol">Claim Holder contract</a> to validate 
the claims linked to an <a href="../assets/eip-3643/ONCHAINID/IIdentity.sol">Identity contract</a>.</p>

<h2 id="security-considerations">Security Considerations</h2>

<p>This specification has been audited by Kapersky and Hacken, and no notable security considerations were found. 
While the audits were primarily focused on the specific implementation by Tokeny, they also challenged and validated the core principles of the T-REX standard. The auditing teams approval of these principles provides assurance that the standard itself is robust and does not present any significant security concerns.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
