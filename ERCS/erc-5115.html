<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>SY Token | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="SY Token | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-5115" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-5115" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">SY Token</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>This standard proposes an API for wrapped yield-bearing tokens within smart contracts. It is an extension on the <a href="./eip-20.md">ERC-20</a> token that provides basic functionality for transferring, depositing, withdrawing tokens, as well as reading balances.</p>

<h2 id="motivation">Motivation</h2>

<p>Yield generating mechanisms are built in all shapes and sizes, necessitating a manual integration every time a protocol builds on top of another protocol’s yield generating mechanism.</p>

<p><a href="./eip-4626.md">ERC-4626</a> tackled a significant part of this fragmentation by standardizing the interfaces for vaults, a major category among various yield generating mechanisms.</p>

<p>In this ERC, we’re extending the coverage to include assets beyond ERC-4626’s reach, namely:</p>

<ul>
  <li>yield-bearing assets that have different input tokens used for minting vs accounting for the pool value.
    <ul>
      <li>This category includes AMM liquidity tokens (which are yield-bearing assets that yield swap fees) since the value of the pool is measured in “liquidity units” (for example, $\sqrt k$ in UniswapV2, as defined in UniswapV2 whitepaper) which can’t be deposited in (as they are not tokens).</li>
      <li>This extends the flexibility in minting the yield-bearing assets. For example, there could be an ETH vault that wants to allow users to deposit cETH directly instead of ETH, for gas efficiency or UX reasons.</li>
    </ul>
  </li>
  <li>Assets with reward tokens by default (e.g. COMP rewards for supplying in Compound). The reward tokens are expected to be sold to compound into the same asset.</li>
  <li>This ERC can be extended further to include the handling of rewards, such as the claiming of accrued multiple rewards tokens.</li>
</ul>

<p>While ERC-4626 is a well-designed and suitable standard for most vaults, there will inevitably be some yield generating mechanisms that do not fit into their category (LP tokens for instance). A more flexible standard is required to standardize the interaction with all types of yield generating mechanisms.</p>

<p>Therefore, we are proposing Standardized Yield (SY), a flexible standard for wrapped yield-bearing tokens that could cover most mechanisms in DeFi. We foresee that:</p>

<ul>
  <li>ERC-4626 will still be a popular vault standard, that most vaults should adopt.</li>
  <li>SY tokens can wrap over most yield generating mechanisms in DeFi, including ERC-4626 vaults for projects built on top of yield-bearing tokens.</li>
  <li>Whoever needs the functionalities of SY could integrate with the existing SY tokens or write a new SY (to wrap over the target yield-bearing token).</li>
  <li>Reward handling can be extended from the SY token.</li>
</ul>

<h3 id="use-cases">Use Cases</h3>

<p>This ERC is designed for flexibility, aiming to accommodate as many yield generating mechanisms as possible. Particularly, this standard aims to be generalized enough that it supports the following use cases and more:</p>

<ul>
  <li>Money market supply positions
    <ul>
      <li>Lending DAI in Compound, getting DAI interests and COMP rewards</li>
      <li>Lending ETH in BenQi, getting ETH interests and QI + AVAX rewards</li>
      <li>Lending USDC in Aave, getting USDC interests and stkAAVE rewards</li>
    </ul>
  </li>
  <li>AMM liquidity provision
    <ul>
      <li>Provide ETH + USDC to ETHUSDC pool in SushiSwap, getting swap fees in more ETH+USDC</li>
      <li>Provide ETH + USDC to ETHUSDC pool in SushiSwap and stake it in Sushi Onsen, getting swap fees and SUSHI rewards</li>
      <li>Provide USDC+DAI+USDT to 3crv pool and stake it in Convex, getting 3crv swap fees and CRV + CVX rewards</li>
    </ul>
  </li>
  <li>Vault positions
    <ul>
      <li>Provide ETH into Yearn ERC-4626 vault, where the vault accrues yield from Yearn’s ETH strategy</li>
      <li>Provide DAI into Harvest and staking it, getting DAI interests and FARM rewards</li>
    </ul>
  </li>
  <li>Liquid staking positions
    <ul>
      <li>Holding stETH (in Lido), getting yields in more stETH</li>
    </ul>
  </li>
  <li>Liquidity mining programs
    <ul>
      <li>Provide USDC in Stargate, getting STG rewards</li>
      <li>Provide LOOKS in LooksRare, getting LOOKS yield and WETH rewards</li>
    </ul>
  </li>
  <li>Rebasing tokens
    <ul>
      <li>Stake OHM into sOHM/gOHM, getting OHM rebase yield</li>
    </ul>
  </li>
</ul>

<p>The ERC hopes to minimize, if not possibly eliminate, the use of customized adapters in order to interact with many different forms of yield-bearing token mechanisms.</p>

<h2 id="specification">Specification</h2>

<h3 id="generic-yield-generating-pool">Generic Yield Generating Pool</h3>

<p>We will first introduce Generic Yield Generating Pool (GYGP), a model to describe most yield generating mechanisms in DeFi. In every yield generating mechanism, there is a pool of funds, whose value is measured in <strong>assets</strong>. There are a number of users who contribute liquidity to the pool, in exchange for <strong>shares</strong> of the pool, which represents units of ownership of the pool. Over time, the value (measured in <strong>assets</strong>) of the pool grows, such that each <strong>share</strong> is worth more <strong>assets</strong> over time. The pool could earn a number of <strong>reward tokens</strong> over time, which are distributed to the users according to some logic (for example, proportionally the number of <strong>shares</strong>).</p>

<p>Here are the more concrete definitions of the terms:</p>

<h4 id="gygp-definitions">GYGP Definitions:</h4>

<ul>
  <li><strong>asset</strong>: Is a unit to measure the value of the pool. At time <em>t</em>, the pool has a total value of <em>TotalAsset(t)</em> <strong>assets</strong>.</li>
  <li><strong>shares</strong>: Is a unit that represents ownership of the pool. At time <em>t</em>, there are <em>TotalShares(t)</em> <strong>shares</strong> in total.</li>
  <li><strong>reward tokens</strong>: Over time, the pool earns $n_{rewards}$ types of reward tokens $(n_{rewards} \ge 0)$. At time <em>t</em>, $TotalRewards_i(t)$ is the amount of <strong>reward token <em>i</em></strong> that has accumulated for the pool up until time <em>t</em>.</li>
  <li><strong>exchange rate</strong>: At time <em>t</em>, the <strong>exchange rate</strong> <em>ExchangeRate(t)</em> is simply how many <strong>assets</strong> each <strong>shares</strong> is worth $ExchangeRate(t) = \frac{TotalAsset(t)}{TotalShares(t)}$</li>
  <li><strong>users</strong>: At time <em>t</em>, each user <em>u</em> has $shares_u(t)$ <strong>shares</strong> in the pool, which is worth $asset_u(t) = shares_u(t) \cdot ExchangeRate(t)$  <strong>assets</strong>. Until time <em>t</em>, user <em>u</em> is entitled to receive a total of $rewards_{u_i}(t)$ <strong>reward token <em>i</em></strong>. The sum of all users’ shares, assets and rewards should be the same as the total shares, assets and rewards of the whole pool.</li>
</ul>

<h4 id="state-changes">State changes:</h4>

<ol>
  <li>A user deposits $d_a$ <strong>assets</strong> into the pool at time $t$ ($d_a$ could be negative, which means a withdraw from the pool). $d_s = d_a / ExchangeRate(t)$ new <strong>shares</strong> will be created and given
to user (or removed and burned from the user when $d_a$ is negative).</li>
  <li>The pool earns $d_a$ (or loses $−d_a$ if $d_a$ is negative) <strong>assets</strong> at time $t$. The <strong>exchange rate</strong> simply increases (or decreases if $d_a$ is negative) due to the additional assets.</li>
  <li>The pool earns $d_r$ <strong>reward token</strong> $i$. Every user will receive a certain amount of <strong>reward token</strong> $i$.</li>
</ol>

<h4 id="examples-of-gygps-in-defi">Examples of GYGPs in DeFi:</h4>

<table>
  <thead>
    <tr>
      <th>Yield generating mechanism</th>
      <th>Asset</th>
      <th>Shares</th>
      <th>Reward tokens</th>
      <th>Exchange rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>Supply USDC in Compound</td>
      <td>USDC</td>
      <td>cUSDC</td>
      <td>COMP</td>
      <td>USDC value per cUSDC, increases with USDC supply interests</td>
    </tr>
    <tr>
      <td>ETH liquid staking in Lido</td>
      <td>stETH</td>
      <td>wstETH</td>
      <td>None</td>
      <td>stETH value per wstETH, increases with ETH staking rewards</td>
    </tr>
    <tr>
      <td>Stake LOOKS in LooksRare Compounder</td>
      <td>LOOKS</td>
      <td>shares (in contract)</td>
      <td>WETH</td>
      <td>LOOKS value per shares, increases with LOOKS rewards</td>
    </tr>
    <tr>
      <td>Stake APE in $APE Compounder</td>
      <td>sAPE</td>
      <td>shares (in contract)</td>
      <td>APE</td>
      <td>sAPE value per shares, increases with APE rewards</td>
    </tr>
    <tr>
      <td>Provide ETH+USDC liquidity on Sushiswap</td>
      <td>ETHUSDC liquidity (a pool of x ETH + y USDC has sqrt(xy) ETHUSDC liquidity)</td>
      <td>ETHUSDC Sushiswap LP (SLP) token</td>
      <td>None</td>
      <td>ETHUSDC liquidity value per ETHUSDC SLP, increases due to swap fees</td>
    </tr>
    <tr>
      <td>Provide ETH+USDC liquidity on Sushiswap and stake into Onsen</td>
      <td>ETHUSDC liquidity (a pool of x ETH + y USDC has sqrt(xy) ETHUSDC liquidity)</td>
      <td>ETHUSDC Sushiswap LP (SLP) token</td>
      <td>SUSHI</td>
      <td>ETHUSDC liquidity value per ETHUSDC SLP, increases due to swap fees</td>
    </tr>
    <tr>
      <td>Provide BAL+WETH liquidity in Balancer (80% BAL, 20% WETH)</td>
      <td>BALWETH liquidity (a pool of x BAL + y WETH has x^0.8*y^0.2 BALWETH liquidity)</td>
      <td>BALWETH Balancer LP token</td>
      <td>None</td>
      <td>BALWETH liquidity per BALWETH Balancer LP token, increases due to swap fees</td>
    </tr>
    <tr>
      <td>Provide USDC+USDT+DAI liquidity in Curve</td>
      <td>3crv pool’s liquidity (amount of D per 3crv token)</td>
      <td>3crv token</td>
      <td>CRV</td>
      <td>3crv pool’s liquidity per 3crv token, increases due to swap fees</td>
    </tr>
    <tr>
      <td>Provide FRAX+USDC liquidity in Curve then stake LP in Convex</td>
      <td>BALWETH liquidity (a pool of x BAL + y WETH has x^0.8*y^0.2 BALWETH liquidity)</td>
      <td>BALWETH Balancer LP token</td>
      <td>None</td>
      <td>BALWETH liquidity per BALWETH Balancer LP token, increases due to swap fees</td>
    </tr>
  </tbody>
</table>

<h3 id="standardized-yield-token-standard">Standardized Yield Token Standard</h3>

<h4 id="overview">Overview:</h4>

<p>Standardized Yield (SY) is a token standard for any yield generating mechanism that conforms to the GYGP model. Each SY token represents <strong>shares</strong> in a GYGP and allows for interacting with the GYGP via a standard interface.</p>

<p>All SY tokens:</p>

<ul>
  <li><strong>MUST</strong> implement <strong><code class="language-plaintext highlighter-rouge">ERC-20</code></strong> to represent shares in the underlying GYGP.</li>
  <li><strong>MUST</strong> implement ERC-20’s optional metadata extensions <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">symbol</code>, and <code class="language-plaintext highlighter-rouge">decimals</code>, which <strong>SHOULD</strong> reflect the underlying GYGP’s accounting asset’s <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">symbol</code>, and <code class="language-plaintext highlighter-rouge">decimals</code>.</li>
  <li><strong>MAY</strong> implement <a href="./eip-2612.md">ERC-2612</a> to improve the UX of approving SY tokens on various integrations.</li>
  <li><strong>MAY</strong> revert on calls to <code class="language-plaintext highlighter-rouge">transfer</code> and <code class="language-plaintext highlighter-rouge">transferFrom</code> if a SY token is to be non-transferable.</li>
  <li>The ERC-20 operations <code class="language-plaintext highlighter-rouge">balanceOf</code>, <code class="language-plaintext highlighter-rouge">transfer</code>, <code class="language-plaintext highlighter-rouge">totalSupply</code>, etc. <strong>SHOULD</strong> operate on the GYGP “shares”, which represent a claim to ownership on a fraction of the GYGP’s underlying holdings.</li>
</ul>

<h4 id="sy-definitions">SY Definitions:</h4>

<p>On top of the definitions above for GYGPs, we need to define 2 more concepts:</p>

<ul>
  <li>
    <p><strong>input tokens</strong>: Are tokens that can be converted into assets to enter the pool. Each SY can accept several possible input tokens $tokens_{in_{i}}$</p>
  </li>
  <li>
    <p><strong>output tokens</strong>: Are tokens that can be redeemed from assets when exiting the pool. Each SY can have several possible output tokens $tokens_{out_{i}}$</p>
  </li>
</ul>

<h4 id="interface">Interface</h4>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IStandardizedYield</span> <span class="p">{</span>
    <span class="k">event</span> <span class="n">Deposit</span><span class="p">(</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">caller</span><span class="p">,</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">receiver</span><span class="p">,</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">tokenIn</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountDeposited</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountSyOut</span>
    <span class="p">);</span>

    <span class="k">event</span> <span class="n">Redeem</span><span class="p">(</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">caller</span><span class="p">,</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">receiver</span><span class="p">,</span>
        <span class="kt">address</span> <span class="k">indexed</span> <span class="n">tokenOut</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountSyToRedeem</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountTokenOut</span>
    <span class="p">);</span>

    <span class="k">function</span> <span class="n">deposit</span><span class="p">(</span>
        <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
        <span class="kt">address</span> <span class="n">tokenIn</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountTokenToDeposit</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">minSharesOut</span><span class="p">,</span>
        <span class="kt">bool</span> <span class="n">depositFromInternalBalance</span>
    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountSharesOut</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">redeem</span><span class="p">(</span>
        <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">amountSharesToRedeem</span><span class="p">,</span>
        <span class="kt">address</span> <span class="n">tokenOut</span><span class="p">,</span>
        <span class="kt">uint256</span> <span class="n">minTokenOut</span><span class="p">,</span>
        <span class="kt">bool</span> <span class="n">burnFromInternalBalance</span>
    <span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountTokenOut</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">exchangeRate</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">res</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">getTokensIn</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">res</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">getTokensOut</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">res</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">yieldToken</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">previewDeposit</span><span class="p">(</span><span class="kt">address</span> <span class="n">tokenIn</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amountTokenToDeposit</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountSharesOut</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">previewRedeem</span><span class="p">(</span><span class="kt">address</span> <span class="n">tokenOut</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amountSharesToRedeem</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountTokenOut</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">name</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span> <span class="k">memory</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">symbol</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">string</span> <span class="k">memory</span><span class="p">);</span>

    <span class="k">function</span> <span class="n">decimals</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint8</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="methods">Methods</h4>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">deposit</span><span class="p">(</span>
    <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
    <span class="kt">address</span> <span class="n">tokenIn</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountTokenToDeposit</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">minSharesOut</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">depositFromInternalBalance</span>
<span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountSharesOut</span><span class="p">);</span>
</code></pre></div></div>

<p>This function will deposit <em>amountTokenToDeposit</em> of input token $i$ (<em>tokenIn</em>) to mint new SY shares.</p>

<p>If <em>depositFromInternalBalance</em> is set to <em>false</em>, msg.sender will need to initially deposit <em>amountTokenToDeposit</em> of input token $i$ (<em>tokenIn</em>) into the SY contract, then this function will convert the <em>amountTokenToDeposit</em> of input token $i$ into $d_a$ worth of <strong>asset</strong> and deposit this amount into the pool for the <em>receiver</em>, who will receive <em>amountSharesOut</em> of SY tokens (<strong>shares</strong>). If <em>depositFromInternalBalance</em> is set to <em>true</em>, then <em>amountTokenToDeposit</em> of input token $i$ (<em>tokenIn</em>) will be taken from receiver directly (as msg.sender), and will be converted and shares returned to the receiver similarly to the first case.</p>

<p>This function should revert if $amountSharesOut \lt minSharesOut$.</p>

<ul>
  <li><strong>MUST</strong> emit the <code class="language-plaintext highlighter-rouge">Deposit</code> event.</li>
  <li><strong>MUST</strong> support ERC-20’s <code class="language-plaintext highlighter-rouge">approve</code> / <code class="language-plaintext highlighter-rouge">transferFrom</code> flow where <code class="language-plaintext highlighter-rouge">tokenIn</code> are taken from receiver directly (as msg.sender) or if the msg.sender has ERC-20 approved allowance over the input token of the receiver.</li>
  <li><strong>MUST</strong> revert if $amountSharesOut \lt minSharesOut$ (due to deposit limit being reached, slippage, or the user not approving enough <code class="language-plaintext highlighter-rouge">tokenIn</code> **to the SY contract, etc).</li>
  <li><strong>MAY</strong> be payable if the <code class="language-plaintext highlighter-rouge">tokenIn</code> depositing asset is the chain’s native currency (e.g. ETH).</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">redeem</span><span class="p">(</span>
    <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountSharesToRedeem</span><span class="p">,</span>
    <span class="kt">address</span> <span class="n">tokenOut</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">minTokenOut</span><span class="p">,</span>
    <span class="kt">bool</span> <span class="n">burnFromInternalBalance</span>
<span class="p">)</span> <span class="k">external</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountTokenOut</span><span class="p">);</span>
</code></pre></div></div>

<p>This function will redeem the $d_s$ shares, which is equivalent to $d_a = d_s \times ExchangeRate(t)$ assets, from the pool. The $d_a$ assets is converted into exactly <em>amountTokenOut</em> of output token $i$ (<em>tokenOut</em>).</p>

<p>If <em>burnFromInternalBalance</em> is set to <em>false</em>, the user will need to initially deposit <em>amountSharesToRedeem</em> into the SY contract, then this function will burn the floating amount $d_s$ of SY tokens (<strong>shares</strong>) in the SY contract to redeem to output token $i$ (<em>tokenOut</em>). This pattern is similar to UniswapV2 which allows for more gas efficient ways to interact with the contract. If <em>burnFromInternalBalance</em> is set to <em>true</em>, then this function will burn <em>amountSharesToRedeem</em> $d_s$ of SY tokens directly from the user to redeem to output token $i$ (<em>tokenOut</em>).</p>

<p>This function should revert if $amountTokenOut \lt minTokenOut$.</p>

<ul>
  <li><strong>MUST</strong> emit the <code class="language-plaintext highlighter-rouge">Redeem</code> event.</li>
  <li><strong>MUST</strong> support ERC-20’s <code class="language-plaintext highlighter-rouge">approve</code> / <code class="language-plaintext highlighter-rouge">transferFrom</code> flow where the shares are burned from receiver directly (as msg.sender) or if the msg.sender has ERC-20 approved allowance over the shares of the receiver.</li>
  <li><strong>MUST</strong> revert if $amountTokenOut \lt minTokenOut$ (due to redeem limit being reached, slippage, or the user not approving enough <code class="language-plaintext highlighter-rouge">amountSharesToRedeem</code> to the SY contract, etc).</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">exchangeRate</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">res</span><span class="p">);</span>
</code></pre></div></div>

<p>This method updates and returns the latest <strong>exchange rate</strong>, which is the <strong>exchange rate</strong> from SY token amount into asset amount, scaled by a fixed scaling factor of 1e18.</p>

<ul>
  <li><strong>MUST</strong> return $ExchangeRate(t_{now})$ such that $ExchangeRate(t_{now}) \times syBalance / 1e18 = assetBalance$.</li>
  <li><strong>MUST NOT</strong> include fees that are charged against the underlying yield token in the SY contract.</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">getTokensIn</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">res</span><span class="p">);</span>
</code></pre></div></div>

<p>This read-only method returns the list of all input tokens that can be used to deposit into the SY contract.</p>

<ul>
  <li><strong>MUST</strong> return ERC-20 token addresses.</li>
  <li><strong>MUST</strong> return at least one address.</li>
  <li><strong>MUST NOT</strong> revert.</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">getTokensOut</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">res</span><span class="p">);</span>
</code></pre></div></div>

<p>This read-only method returns the list of all output tokens that can be converted into when exiting the SY contract.</p>

<ul>
  <li><strong>MUST</strong> return ERC-20 token addresses.</li>
  <li><strong>MUST</strong> return at least one address.</li>
  <li><strong>MUST NOT</strong> revert.</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">yieldToken</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>
</code></pre></div></div>

<p>This read-only method returns the underlying yield-bearing token (representing a GYGP) address.</p>

<ul>
  <li><strong>MUST</strong> return a token address that conforms to the ERC-20 interface, or zero address</li>
  <li><strong>MUST NOT</strong> revert.</li>
  <li><strong>MUST</strong> reflect the exact underlying yield-bearing token address if the SY token is a wrapped token.</li>
  <li><strong>MAY</strong> return 0x or zero address if the SY token is natively implemented, and not from wrapping.</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">previewDeposit</span><span class="p">(</span><span class="kt">address</span> <span class="n">tokenIn</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amountTokenToDeposit</span><span class="p">)</span>
    <span class="k">external</span>
    <span class="k">view</span>
    <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountSharesOut</span><span class="p">);</span>
</code></pre></div></div>

<p>This read-only method returns the amount of shares that a user would have received if they deposit <em>amountTokenToDeposit</em> of <em>tokenIn</em>.</p>

<ul>
  <li><strong>MUST</strong> return less than or equal of <em>amountSharesOut</em> to the actual return value of the <code class="language-plaintext highlighter-rouge">deposit</code> method, and <strong>SHOULD NOT</strong> return greater than the actual return value of the <code class="language-plaintext highlighter-rouge">deposit</code> method.</li>
  <li><strong>SHOULD ONLY</strong> revert if minting SY token with the entered parameters is forbidden (e.g. exceeding supply cap).</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">function</span> <span class="n">previewRedeem</span><span class="p">(</span><span class="kt">address</span> <span class="n">tokenOut</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amountSharesToRedeem</span><span class="p">)</span>
    <span class="k">external</span>
    <span class="k">view</span>
    <span class="k">returns</span> <span class="p">(</span><span class="kt">uint256</span> <span class="n">amountTokenOut</span><span class="p">);</span>
</code></pre></div></div>

<p>This read-only method returns the amount of <em>tokenOut</em> that a user would have received if they redeem <em>amountSharesToRedeem</em> of <em>tokenOut</em>.</p>

<ul>
  <li><strong>MUST</strong> return less than or equal of <em>amountTokenOut</em> to the actual return value of the <code class="language-plaintext highlighter-rouge">redeem</code> method, and <strong>SHOULD NOT</strong> return greater than the actual return value of the <code class="language-plaintext highlighter-rouge">redeem</code> method.</li>
  <li><strong>SHOULD ONLY</strong> revert if burning SY token with the entered parameters is forbidden.</li>
</ul>

<h4 id="events">Events</h4>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">event</span> <span class="n">Deposit</span><span class="p">(</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">caller</span><span class="p">,</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">receiver</span><span class="p">,</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">tokenIn</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountDeposited</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountSyOut</span>
<span class="p">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">caller</code> has converted exact <em>tokenIn</em> tokens into SY (shares) and transferred those SY to <code class="language-plaintext highlighter-rouge">receiver</code>.</p>

<ul>
  <li><strong>MUST</strong> be emitted when input tokens are deposited into the SY contract via <code class="language-plaintext highlighter-rouge">deposit</code> method.</li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">event</span> <span class="n">Redeem</span><span class="p">(</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">caller</span><span class="p">,</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">receiver</span><span class="p">,</span>
    <span class="kt">address</span> <span class="k">indexed</span> <span class="n">tokenOut</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountSyToRedeem</span><span class="p">,</span>
    <span class="kt">uint256</span> <span class="n">amountTokenOut</span>
<span class="p">);</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">caller</code> has converted exact SY (shares) into input tokens and transferred those input tokens to <code class="language-plaintext highlighter-rouge">receiver</code>.</p>

<ul>
  <li><strong>MUST</strong> be emitted when input tokens are redeemed from the SY contract via <code class="language-plaintext highlighter-rouge">redeem</code> method.</li>
</ul>

<p><strong>“SY” Word Choice:</strong></p>

<p>“SY” (pronunciation: <em>/sʌɪ/</em>), an abbreviation of Standardized Yield, was found to be appropriate to describe a broad universe of standardized composable yield-bearing digital assets.</p>

<h2 id="rationale">Rationale</h2>

<p><a href="./eip-20.md">ERC-20</a> is enforced because implementation details such as transfer, token approvals, and balance calculation directly carry over to the SY tokens. This standardization makes the SY tokens immediately compatible with all ERC-20 use cases.</p>

<p><a href="./eip-165.md">ERC-165</a> can optionally be implemented should you want integrations to detect the IStandardizedYield interface implementation.</p>

<p><a href="./eip-2612.md">ERC-2612</a> can optionally be implemented in order to improve the UX of approving SY tokens on various integrations.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>This ERC is fully backwards compatible as its implementation extends the functionality of <a href="./eip-20.md">ERC-20</a>, however the optional metadata extensions, namely <code class="language-plaintext highlighter-rouge">name</code>, <code class="language-plaintext highlighter-rouge">decimals</code>, and <code class="language-plaintext highlighter-rouge">symbol</code> semantics MUST be implemented for all SY token implementations.</p>

<h2 id="security-considerations">Security Considerations</h2>

<p>Malicious implementations which conform to the interface can put users at risk. It is recommended that all integrators (such as wallets, aggregators, or other smart contract protocols) review the implementation to avoid possible exploits and users losing funds.</p>

<p><code class="language-plaintext highlighter-rouge">yieldToken</code> must strongly reflect the address of the underlying wrapped yield-bearing token. For a native implementation wherein the SY token does not wrap a yield-bearing token, but natively represents a GYGP share, then the address returned MAY be a zero address. Otherwise, for wrapped tokens, you may introduce confusion on what the SY token represents, or may be deemed malicious.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
