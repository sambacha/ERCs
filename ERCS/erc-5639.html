<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Delegation Registry | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Delegation Registry | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-5639" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-5639" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Delegation Registry</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>This EIP describes the details of the Delegation Registry, a proposed protocol and ABI definition that provides the ability to link one or more delegate wallets to a vault wallet in a manner which allows the linked delegate wallets to prove control and asset ownership of the vault wallet.</p>

<h2 id="motivation">Motivation</h2>

<p>Proving ownership of an asset to a third party application in the Ethereum ecosystem is common. Users frequently sign payloads of data to authenticate themselves before gaining access to perform some operation. However, this method–akin to giving the third party root access to one’s main wallet–is both insecure and inconvenient.</p>

<p><strong><em>Examples:</em></strong></p>

<ol>
  <li>In order for you to edit your profile on OpenSea, you must sign a message with your wallet.</li>
  <li>In order to access NFT gated content, you must sign a message with the wallet containing the NFT in order to prove ownership.</li>
  <li>In order to gain access to an event, you must sign a message with the wallet containing a required NFT in order to prove ownership.</li>
  <li>In order to claim an airdrop, you must interact with the smart contract with the qualifying wallet.</li>
  <li>In order to prove ownership of an NFT, you must sign a payload with the wallet that owns that NFT.</li>
</ol>

<p>In all the above examples, one interacts with the dApp or smart contract using the wallet itself, which may be</p>

<ul>
  <li>inconvenient (if it is controlled via a hardware wallet or a multi-sig)</li>
  <li>insecure (since the above operations are read-only, but you are signing/interacting via a wallet that has write access)</li>
</ul>

<p>Instead, one should be able to approve multiple wallets to authenticate on behalf of a given wallet.</p>

<h3 id="problems-with-existing-methods-and-solutions">Problems with existing methods and solutions</h3>

<p>Unfortunately, we’ve seen many cases where users have accidentally signed a malicious payload. The result is almost always a significant loss of assets associated with the delegate address.</p>

<p>In addition to this, many users keep significant portions of their assets in ‘cold storage’. With the increased security from ‘cold storage’ solutions, we usually see decreased accessibility because users naturally increase the barriers required to access these wallets.</p>

<h3 id="proposal-use-of-a-delegation-registry">Proposal: Use of a Delegation Registry</h3>

<p>This proposal aims to provide a mechanism which allows a vault wallet to grant wallet, contract or token level permissions to a delegate wallet. This would achieve a safer and more convenient way to sign and authenticate, and provide ‘read only’ access to a vault wallet via one or more secondary wallets.</p>

<p>From there, the benefits are twofold. This EIP gives users increased security via outsourcing potentially malicious signing operations to wallets that are more accessible (hot wallets), while being able to maintain the intended security assumptions of wallets that are not frequently used for signing operations.</p>

<h4 id="improving-dapp-interaction-security">Improving dApp Interaction Security</h4>

<p>Many dApps requires one to prove control of a wallet to gain access. At the moment, this means that you must interact with the dApp using the wallet itself. This is a security issue, as malicious dApps or phishing sites can lead to the assets of the wallet being compromised by having them sign malicious payloads.</p>

<p>However, this risk would be mitigated if one were to use a secondary wallet for these interactions. Malicious interactions would be isolated to the assets held in the secondary wallet, which can be set up to contain little to nothing of value.</p>

<h4 id="improving-multiple-device-access-security">Improving Multiple Device Access Security</h4>

<p>In order for a non-hardware wallet to be used on multiple devices, you must import the seed phrase to each device. Each time a seed phrase is entered on a new device, the risk of the wallet being compromised increases as you are increasing the surface area of devices that have knowledge of the seed phrase.</p>

<p>Instead, each device can have its own unique wallet that is an authorized secondary wallet of the main wallet. If a device specific wallet was ever compromised or lost, you could simply remove the authorization to authenticate.</p>

<p>Further, wallet authentication can be chained so that a secondary wallet could itself authorize one or many tertiary wallets, which then have signing rights for both the secondary address as well as the root main address. This, can allow teams to each have their own signer while the main wallet can easily invalidate an entire tree, just by revoking rights from the root stem.</p>

<h4 id="improving-convenience">Improving Convenience</h4>

<p>Many invididuals use hardware wallets for maximum security. However, this is often inconvenient, since many do not want to carry their hardware wallet with them at all times.</p>

<p>Instead, if you approve a non-hardware wallet for authentication activities (such as a mobile device), you would be able to use most dApps without the need to have your hardware wallet on hand.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119.</p>

<p>Let:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">vault</code> represent the vault address we are trying to authenticate or prove asset ownership for.</li>
  <li><code class="language-plaintext highlighter-rouge">delegate</code> represent the address we want to use for signing in lieu of <code class="language-plaintext highlighter-rouge">vault</code>.</li>
</ul>

<p><strong>A Delegation Registry must implement IDelegationRegistry</strong></p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @title An immutable registry contract to be deployed as a standalone primitive
 * @dev New project launches can read previous cold wallet -&gt; hot wallet delegations
 * from here and integrate those permissions into their flow
 */</span>
<span class="k">interface</span> <span class="n">IDelegationRegistry</span> <span class="p">{</span>
    <span class="c1">/// @notice Delegation type
</span>    <span class="k">enum</span> <span class="n">DelegationType</span> <span class="p">{</span>
        <span class="n">NONE</span><span class="p">,</span>
        <span class="n">ALL</span><span class="p">,</span>
        <span class="n">CONTRACT</span><span class="p">,</span>
        <span class="n">TOKEN</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Info about a single delegation, used for onchain enumeration
</span>    <span class="k">struct</span> <span class="n">DelegationInfo</span> <span class="p">{</span>
        <span class="n">DelegationType</span> <span class="n">type_</span><span class="p">;</span>
        <span class="kt">address</span> <span class="n">vault</span><span class="p">;</span>
        <span class="kt">address</span> <span class="n">delegate</span><span class="p">;</span>
        <span class="kt">address</span> <span class="n">contract_</span><span class="p">;</span>
        <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Info about a single contract-level delegation
</span>    <span class="k">struct</span> <span class="n">ContractDelegation</span> <span class="p">{</span>
        <span class="kt">address</span> <span class="n">contract_</span><span class="p">;</span>
        <span class="kt">address</span> <span class="n">delegate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Info about a single token-level delegation
</span>    <span class="k">struct</span> <span class="n">TokenDelegation</span> <span class="p">{</span>
        <span class="kt">address</span> <span class="n">contract_</span><span class="p">;</span>
        <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">;</span>
        <span class="kt">address</span> <span class="n">delegate</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Emitted when a user delegates their entire wallet
</span>    <span class="k">event</span> <span class="n">DelegateForAll</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">);</span>

    <span class="c1">/// @notice Emitted when a user delegates a specific contract
</span>    <span class="k">event</span> <span class="n">DelegateForContract</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">);</span>

    <span class="c1">/// @notice Emitted when a user delegates a specific token
</span>    <span class="k">event</span> <span class="n">DelegateForToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">);</span>

    <span class="c1">/// @notice Emitted when a user revokes all delegations
</span>    <span class="k">event</span> <span class="n">RevokeAllDelegates</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">);</span>

    <span class="c1">/// @notice Emitted when a user revoes all delegations for a given delegate
</span>    <span class="k">event</span> <span class="n">RevokeDelegate</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">delegate</span><span class="p">);</span>

    <span class="cm">/**
     * -----------  WRITE -----------
     */</span>

    <span class="cm">/**
     * @notice Allow the delegate to act on your behalf for all contracts
     * @param delegate The hotwallet to act on your behalf
     * @param value Whether to enable or disable delegation for this address, true for setting and false for revoking
     */</span>
    <span class="k">function</span> <span class="n">delegateForAll</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * @notice Allow the delegate to act on your behalf for a specific contract
     * @param delegate The hotwallet to act on your behalf
     * @param contract_ The address for the contract you're delegating
     * @param value Whether to enable or disable delegation for this address, true for setting and false for revoking
     */</span>
    <span class="k">function</span> <span class="n">delegateForContract</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * @notice Allow the delegate to act on your behalf for a specific token
     * @param delegate The hotwallet to act on your behalf
     * @param contract_ The address for the contract you're delegating
     * @param tokenId The token id for the token you're delegating
     * @param value Whether to enable or disable delegation for this address, true for setting and false for revoking
     */</span>
    <span class="k">function</span> <span class="n">delegateForToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">value</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * @notice Revoke all delegates
     */</span>
    <span class="k">function</span> <span class="n">revokeAllDelegates</span><span class="p">()</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * @notice Revoke a specific delegate for all their permissions
     * @param delegate The hotwallet to revoke
     */</span>
    <span class="k">function</span> <span class="n">revokeDelegate</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * @notice Remove yourself as a delegate for a specific vault
     * @param vault The vault which delegated to the msg.sender, and should be removed
     */</span>
    <span class="k">function</span> <span class="n">revokeSelf</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>

    <span class="cm">/**
     * -----------  READ -----------
     */</span>

    <span class="cm">/**
     * @notice Returns all active delegations a given delegate is able to claim on behalf of
     * @param delegate The delegate that you would like to retrieve delegations for
     * @return info Array of DelegationInfo structs
     */</span>
    <span class="k">function</span> <span class="n">getDelegationsByDelegate</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">DelegationInfo</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns an array of wallet-level delegates for a given vault
     * @param vault The cold wallet who issued the delegation
     * @return addresses Array of wallet-level delegates for a given vault
     */</span>
    <span class="k">function</span> <span class="n">getDelegatesForAll</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns an array of contract-level delegates for a given vault and contract
     * @param vault The cold wallet who issued the delegation
     * @param contract_ The address for the contract you're delegating
     * @return addresses Array of contract-level delegates for a given vault and contract
     */</span>
    <span class="k">function</span> <span class="n">getDelegatesForContract</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns an array of contract-level delegates for a given vault's token
     * @param vault The cold wallet who issued the delegation
     * @param contract_ The address for the contract holding the token
     * @param tokenId The token id for the token you're delegating
     * @return addresses Array of contract-level delegates for a given vault's token
     */</span>
    <span class="k">function</span> <span class="n">getDelegatesForToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">[]</span> <span class="k">memory</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns all contract-level delegations for a given vault
     * @param vault The cold wallet who issued the delegations
     * @return delegations Array of ContractDelegation structs
     */</span>
    <span class="k">function</span> <span class="n">getContractLevelDelegations</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="n">ContractDelegation</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">delegations</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns all token-level delegations for a given vault
     * @param vault The cold wallet who issued the delegations
     * @return delegations Array of TokenDelegation structs
     */</span>
    <span class="k">function</span> <span class="n">getTokenLevelDelegations</span><span class="p">(</span><span class="kt">address</span> <span class="n">vault</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">TokenDelegation</span><span class="p">[]</span> <span class="k">memory</span> <span class="n">delegations</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns true if the address is delegated to act on the entire vault
     * @param delegate The hotwallet to act on your behalf
     * @param vault The cold wallet who issued the delegation
     */</span>
    <span class="k">function</span> <span class="n">checkDelegateForAll</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">vault</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns true if the address is delegated to act on your behalf for a token contract or an entire vault
     * @param delegate The hotwallet to act on your behalf
     * @param contract_ The address for the contract you're delegating
     * @param vault The cold wallet who issued the delegation
     */</span>
    <span class="k">function</span> <span class="n">checkDelegateForContract</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="cm">/**
     * @notice Returns true if the address is delegated to act on your behalf for a specific token, the token's contract or an entire vault
     * @param delegate The hotwallet to act on your behalf
     * @param contract_ The address for the contract you're delegating
     * @param tokenId The token id for the token you're delegating
     * @param vault The cold wallet who issued the delegation
     */</span>
    <span class="k">function</span> <span class="n">checkDelegateForToken</span><span class="p">(</span><span class="kt">address</span> <span class="n">delegate</span><span class="p">,</span> <span class="kt">address</span> <span class="n">vault</span><span class="p">,</span> <span class="kt">address</span> <span class="n">contract_</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="checking-delegation">Checking Delegation</h3>

<p>A dApp or smart contract would check whether or not a delegate is authenticated for a vault by checking the return value of checkDelegateForAll.</p>

<p>A dApp or smart contract would check whether or not a delegate can authenticated for a contract associated with a by checking the return value of checkDelegateForContract.</p>

<p>A dApp or smart contract would check whether or not a delegate can authenticated for a specific token owned by a vault by checking the return value of checkDelegateForToken.</p>

<p>A delegate can act on a token if they have a token level delegation, contract level delegation (for that token’s contract) or vault level delegation.</p>

<p>A delegate can act on a contract if they have contract level delegation or vault level delegation.</p>

<p>For the purposes of saving gas, it is expected if delegation checks are performed at a smart contract level, the dApp would provide a hint to the smart contract which level of delegation the delegate has so that the smart contract can verify with the Delegation Registry using the most gas efficient check method.</p>

<h2 id="rationale">Rationale</h2>

<h3 id="allowing-for-vault-contract-or-token-level-delegation">Allowing for vault, contract or token level delegation</h3>

<p>In order to support a wide range of delegation use cases, the proposed specification allows a vault to delegate all assets it controls, assets of a specific contract, or a specific token. This ensures that a vault has fine grained control over the security of their assets, and allows for emergent behavior around granting third party wallets limited access only to assets relevant to them.</p>

<h3 id="on-chain-enumeration">On-chain enumeration</h3>

<p>In order to support ease of integration and adoption, this specification has chosen to include on-chain enumeration of delegations and incur the additional gas cost associated with supporting enumeration. On-chain enumeration allows for dApp frontends to identify the delegations that any connected wallet has access to, and can provide UI selectors.</p>

<p>Without on-chain enumeration, a dApp would require the user to manually input the vault, or would need a way to index all delegate events.</p>

<h2 id="security-considerations">Security Considerations</h2>

<p>The core purpose of this EIP is to enhance security and promote a safer way to authenticate wallet control and asset ownership when the main wallet is not needed and assets held by the main wallet do not need to be moved. Consider it a way to do ‘read only’ authentication.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
