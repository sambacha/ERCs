<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Bit Based Permission | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Bit Based Permission | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-6617" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-6617" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Bit Based Permission</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>This EIP offers a standard for building a bit-based permission and role system. Each permission is represented by a single bit. By using an <code class="language-plaintext highlighter-rouge">uint256</code>, up to $256$ permissions and $2^{256}$ roles can be defined. We are able to specify the importance of each permission based on the order of the bits.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119 and RFC 8174.</p>

<p><em>Note</em> The following specifications use syntax from Solidity <code class="language-plaintext highlighter-rouge">0.8.7</code> (or above)</p>

<p>Interface of reference is described as followed:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">pragma</span> <span class="n">solidity</span> <span class="o">^</span><span class="mf">0.8</span><span class="p">.</span><span class="mi">7</span><span class="p">;</span>

<span class="cm">/**
    @title EIP-6617 Bit Based Permission
    @dev See https://eips.ethereum.org/EIPS/eip-6617
*/</span>
<span class="k">interface</span> <span class="n">IEIP6617</span> <span class="p">{</span>

    <span class="cm">/**
        MUST trigger when a permission is granted.
        @param _grantor        Grantor of the permission
        @param _permission     Permission that is granted
        @param _user           User who received the permission
    */</span>
    <span class="k">event</span> <span class="n">PermissionGranted</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_grantor</span><span class="p">,</span> <span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">_permission</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">_user</span><span class="p">);</span>

    <span class="cm">/**
        MUST trigger when a permission is revoked.
        @param _revoker        Revoker of the permission
        @param _permission     Permission that is revoked
        @param _user           User who lost the permission
    */</span>
    <span class="k">event</span> <span class="n">PermissionRevoked</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">_revoker</span><span class="p">,</span> <span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">_permission</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">_user</span><span class="p">);</span>

    <span class="cm">/**
        @notice Check if user has permission
        @param _user                Address of the user whose permission we need to check
        @param _requiredPermission  The required permission
        @return                     True if the _permission is a superset of the _requiredPermission else False
    */</span>
    <span class="k">function</span> <span class="n">hasPermission</span><span class="p">(</span><span class="kt">address</span> <span class="n">_user</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_requiredPermission</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">view</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="cm">/**
        @notice Add permission to user
        @param _user                Address of the user to whom we are going to add a permission
        @param _permissionToAdd     The permission that will be added
        @return                     The new permission with the _permissionToAdd
    */</span>
    <span class="k">function</span> <span class="n">grantPermission</span><span class="p">(</span><span class="kt">address</span> <span class="n">_user</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_permissionToAdd</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="cm">/**
        @notice Revoke permission from user
        @param _user                Address of the user to whom we are going to revoke a permission
        @param _permissionToRevoke  The permission that will be revoked
        @return                     The new permission without the _permissionToRevoke
    */</span>
    <span class="k">function</span> <span class="n">revokePermission</span><span class="p">(</span><span class="kt">address</span> <span class="n">_user</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">_permissionToRevoke</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<ul>
  <li>Compliant contracts MUST implement <code class="language-plaintext highlighter-rouge">IEIP6617</code></li>
  <li>A permission in a compliant contract is represented as an <code class="language-plaintext highlighter-rouge">uint256</code>. A permission MUST take only one bit of an <code class="language-plaintext highlighter-rouge">uint256</code> and therefore MUST be a power of 2. Each permission MUST be unique and the <code class="language-plaintext highlighter-rouge">0</code> MUST be used for none permission.</li>
</ul>

<h3 id="metadata-interface">Metadata Interface</h3>

<p>It is RECOMMENDED for compliant contracts to implement the optional extension <code class="language-plaintext highlighter-rouge">IEIP6617Meta</code>.</p>

<ul>
  <li>
    <p>They SHOULD define a name and description for the base permissions and main combinaison.</p>
  </li>
  <li>
    <p>They SHOULD NOT define a description for every subcombinaison of permissions possible.</p>
  </li>
</ul>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">/**
 * @dev Defined the interface of the metadata of EIP6617, MAY NOT be implemented
 */</span>
<span class="k">interface</span> <span class="n">IEIP6617Meta</span> <span class="p">{</span>
    
    <span class="cm">/**
        Structure of permission description
        @param _permission     Permission
        @param _name           Name of the permission
        @param _description    Description of the permission
    */</span>
    <span class="k">struct</span> <span class="n">PermissionDescription</span> <span class="p">{</span>
        <span class="kt">uint256</span> <span class="n">permission</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">name</span><span class="p">;</span>
        <span class="kt">string</span> <span class="n">description</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="cm">/**
        MUST trigger when the description is updated.
        @param _permission     Permission
        @param _name           Name of the permission
        @param _description    Description of the permission
    */</span>
    <span class="k">event</span> <span class="n">UpdatePermissionDescription</span><span class="p">(</span><span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">_permission</span><span class="p">,</span> <span class="kt">string</span> <span class="k">indexed</span> <span class="n">_name</span><span class="p">,</span> <span class="kt">string</span> <span class="k">indexed</span> <span class="n">_description</span><span class="p">);</span>

    <span class="cm">/**
        Returns the description of a given `_permission`.
        @param _permission     Permission
    */</span>
    <span class="k">function</span> <span class="n">getPermissionDescription</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_permission</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="n">PermissionDescription</span> <span class="k">memory</span> <span class="n">description</span><span class="p">);</span>

    <span class="cm">/**
        Return `true` if the description was set otherwise return `false`. It MUST emit `UpdatePermissionDescription` event.
        @param _permission     Permission
        @param _name           Name of the permission
        @param _description    Description of the permission
    */</span>
    <span class="k">function</span> <span class="n">setPermissionDescription</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">_permission</span><span class="p">,</span> <span class="kt">string</span> <span class="k">memory</span> <span class="n">_name</span><span class="p">,</span> <span class="kt">string</span> <span class="k">memory</span> <span class="n">_description</span><span class="p">)</span>
        <span class="k">external</span>
        <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span> <span class="n">success</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="rationale">Rationale</h2>

<p>Currently permission and access control is performed using a single owner (<a href="./eip-173.md">ERC-173</a>) or with <code class="language-plaintext highlighter-rouge">bytes32</code> roles (<a href="./eip-5982.md">ERC-5982</a>).
However, using bitwise and bitmask operations allows for greater gas-efficiency and flexibility.</p>

<h3 id="gas-cost-efficiency">Gas cost efficiency</h3>

<p>Bitwise operations are very cheap and fast. For example, doing an <code class="language-plaintext highlighter-rouge">AND</code> bitwise operation on a permission bitmask is significantly cheaper than calling any number of <code class="language-plaintext highlighter-rouge">LOAD</code> opcodes.</p>

<h3 id="flexibility">Flexibility</h3>

<p>With the 256 bits of the <code class="language-plaintext highlighter-rouge">uint256</code>, we can create up to 256 different permissions which leads to $2^{256}$ unique combinations (a.k.a. roles).
<em>(A role is a combination of multiple permissions).</em> Not all roles have to be predefined.</p>

<p>Since permissions are defined as unsigned integers, we can use the binary OR operator to create new role based on multiple permissions.</p>

<h3 id="ordering-permissions-by-importance">Ordering permissions by importance</h3>

<p>We can use the most significant bit to represent the most important permission, the comparison between permissions can then be done easily since they all are <code class="language-plaintext highlighter-rouge">uint256</code>s.</p>

<h3 id="associate-a-meaning">Associate a meaning</h3>

<p>Compared with access control managed via ERC-5982, this EIP does not provide a direct and simple understanding of the meaning of a permission or role.</p>

<p>To deal with this problem, you can set up the metadata interface, which associates a name and description to each permission or role.</p>

<h2 id="reference-implementation">Reference Implementation</h2>

<p>First implementation could be found here:</p>

<ul>
  <li><a href="../assets/eip-6617/contracts/EIP6617.sol">Basic ERC-6617 implementation</a></li>
</ul>

<h2 id="security-considerations">Security Considerations</h2>

<p>No security considerations.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
