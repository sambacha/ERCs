<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Minimal Multi-Token Interface | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Minimal Multi-Token Interface | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-6909" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-6909" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Minimal Multi-Token Interface</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>The following specifies a multi-token contract as a simplified alternative to the <a href="./eip-1155.md">ERC-1155</a> Multi-Token Standard. In contrast to ERC-1155, callbacks and batching have been removed from the interface and the permission system is a hybrid operator-approval scheme for granular and scalable permissions. Functionally, the interface has been reduced to the bare minimum required to manage multiple tokens under the same contract.</p>

<h2 id="motivation">Motivation</h2>

<p>The ERC-1155 standard includes unnecessary features such as requiring recipient accounts with code to implement callbacks returning specific values and batch-calls in the specification. In addition, the single operator permission scheme grants unlimited allowance on every token ID in the contract. Backwards compatibility is deliberately removed only where necessary. Additional features such as batch calls, increase and decrease allowance methods, and other user experience improvements are deliberately omitted in the specification to minimize the required external interface.</p>

<p>According to ERC-1155, callbacks are required for each transfer and batch transfer to contract accounts. This requires potentially unnecessary external calls to the recipient when the recipient account is a contract account. While this behavior may be desirable in some cases, there is no option to opt-out of this behavior, as is the case for <a href="./eip-721.md">ERC-721</a> having both <code class="language-plaintext highlighter-rouge">transferFrom</code> and <code class="language-plaintext highlighter-rouge">safeTransferFrom</code>. In addition to runtime performance of the token contract itself, it also impacts the runtime performance and codesize of recipient contract accounts, requiring multiple callback functions and return values to receive the tokens.</p>

<p>Batching transfers, while useful, are excluded from this standard to allow for opinionated batch transfer operations on different implementations. For example, a different ABI encoding may provide different benefits in different environments such as calldata size optimization for rollups with calldata storage commitments or runtime performance for environments with expensive gas fees.</p>

<p>A hybrid allowance-operator permission scheme enables granular yet scalable controls on token approvals. Allowances enable an external account to transfer tokens of a single token ID on a user’s behalf w by their ID while operators are granted full transfer permission for all token IDs for the user.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119 and RFC 8174.</p>

<h3 id="definitions">Definitions</h3>

<ul>
  <li>infinite: The maximum value for a uint256 (<code class="language-plaintext highlighter-rouge">2 ** 256 - 1</code>).</li>
  <li>caller: The caller of the current context (<code class="language-plaintext highlighter-rouge">msg.sender</code>).</li>
  <li>spender: An account that transfers tokens on behalf of another account.</li>
  <li>operator: An account that has unlimited transfer permissions on all token ids for another account.</li>
  <li>mint: The creation of an amount of tokens. This MAY happen in a mint method or as a transfer from the zero address.</li>
  <li>burn: The removal an amount of tokens. This MAY happen in a burn method or as a transfer to the zero address.</li>
</ul>

<h3 id="methods">Methods</h3>

<h4 id="balanceof"><code class="language-plaintext highlighter-rouge">balanceOf</code></h4>

<p>The total <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> that an <code class="language-plaintext highlighter-rouge">owner</code> owns.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">balanceOf</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">owner</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h4 id="allowance"><code class="language-plaintext highlighter-rouge">allowance</code></h4>

<p>The total <code class="language-plaintext highlighter-rouge">amount</code> of a token id that a spender is permitted to transfer on behalf of an owner.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">allowance</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">owner</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h4 id="isoperator"><code class="language-plaintext highlighter-rouge">isOperator</code></h4>

<p>Returns <code class="language-plaintext highlighter-rouge">true</code> if the <code class="language-plaintext highlighter-rouge">spender</code> is approved as an operator for an <code class="language-plaintext highlighter-rouge">owner</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">isOperator</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">owner</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">status</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h4 id="transfer"><code class="language-plaintext highlighter-rouge">transfer</code></h4>

<p>Transfers an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> from the caller to the <code class="language-plaintext highlighter-rouge">receiver</code>.</p>

<p>MUST revert when the caller’s balance for the token <code class="language-plaintext highlighter-rouge">id</code> is insufficient.</p>

<p>MUST log the <code class="language-plaintext highlighter-rouge">Transfer</code> event.</p>

<p>MUST return True.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">transfer</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">nonpayable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">receiver</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">success</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h4 id="transferfrom"><code class="language-plaintext highlighter-rouge">transferFrom</code></h4>

<p>Transfers an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> from a <code class="language-plaintext highlighter-rouge">sender</code> to a <code class="language-plaintext highlighter-rouge">receiver</code> by the caller.</p>

<p>MUST revert when the caller is not an operator for the <code class="language-plaintext highlighter-rouge">sender</code> and the caller’s allowance for the token <code class="language-plaintext highlighter-rouge">id</code> for the <code class="language-plaintext highlighter-rouge">sender</code> is insufficient.</p>

<p>MUST revert when the <code class="language-plaintext highlighter-rouge">sender</code>’s balance for the token id is insufficient.</p>

<p>MUST log the <code class="language-plaintext highlighter-rouge">Transfer</code> event.</p>

<p>MUST decrease the caller’s <code class="language-plaintext highlighter-rouge">allowance</code> by the same <code class="language-plaintext highlighter-rouge">amount</code> of the <code class="language-plaintext highlighter-rouge">sender</code>’s balance decrease if the caller is not an operator for the <code class="language-plaintext highlighter-rouge">sender</code> and the caller’s <code class="language-plaintext highlighter-rouge">allowance</code> is not infinite.</p>

<p>SHOULD NOT decrease the caller’s <code class="language-plaintext highlighter-rouge">allowance</code> for the token <code class="language-plaintext highlighter-rouge">id</code> for the <code class="language-plaintext highlighter-rouge">sender</code> if the <code class="language-plaintext highlighter-rouge">allowance</code> is infinite.</p>

<p>SHOULD NOT decrease the caller’s <code class="language-plaintext highlighter-rouge">allowance</code> for the token <code class="language-plaintext highlighter-rouge">id</code> for the <code class="language-plaintext highlighter-rouge">sender</code> if the caller is an operator.</p>

<p>MUST return True.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">transferFrom</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">nonpayable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sender</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">receiver</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">success</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h4 id="approve"><code class="language-plaintext highlighter-rouge">approve</code></h4>

<p>Approves an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> that a <code class="language-plaintext highlighter-rouge">spender</code> is permitted to transfer on behalf of the caller.</p>

<p>MUST set the <code class="language-plaintext highlighter-rouge">allowance</code> of the <code class="language-plaintext highlighter-rouge">spender</code> of the token <code class="language-plaintext highlighter-rouge">id</code> for the caller to the <code class="language-plaintext highlighter-rouge">amount</code>.</p>

<p>MUST log the <code class="language-plaintext highlighter-rouge">Approval</code> event.</p>

<p>MUST return True.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">approve</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">nonpayable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">success</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h4 id="setoperator"><code class="language-plaintext highlighter-rouge">setOperator</code></h4>

<p>Grants or revokes unlimited transfer permissions for a <code class="language-plaintext highlighter-rouge">spender</code> for any token <code class="language-plaintext highlighter-rouge">id</code> on behalf of the caller.</p>

<p>MUST set the operator status to the <code class="language-plaintext highlighter-rouge">approved</code> value.</p>

<p>MUST log the <code class="language-plaintext highlighter-rouge">OperatorSet</code> event.</p>

<p>MUST return True.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">setOperator</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">nonpayable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">approved</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">success</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h3 id="events">Events</h3>

<h4 id="transfer-1"><code class="language-plaintext highlighter-rouge">Transfer</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">caller</code> initiates a transfer of an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> from a <code class="language-plaintext highlighter-rouge">sender</code> to a <code class="language-plaintext highlighter-rouge">receiver</code>.</p>

<p>MUST be logged when an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> is transferred from one account to another.</p>

<p>MUST be logged with the <code class="language-plaintext highlighter-rouge">sender</code> address as the zero address when an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> is minted.</p>

<p>MUST be logged with the <code class="language-plaintext highlighter-rouge">receiver</code> address as the zero address when an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> is burned.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Transfer</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">event</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">caller</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">sender</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">receiver</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h4 id="operatorset"><code class="language-plaintext highlighter-rouge">OperatorSet</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">owner</code> has set the <code class="language-plaintext highlighter-rouge">approved</code> status to a <code class="language-plaintext highlighter-rouge">spender</code>.</p>

<p>MUST be logged when the operator status is set.</p>

<p>MAY be logged when the operator status is set to the same status it was before the current call.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">OperatorSet</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">event</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">owner</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">approved</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">bool</span>
</code></pre></div></div>

<h4 id="approval"><code class="language-plaintext highlighter-rouge">Approval</code></h4>

<p>The <code class="language-plaintext highlighter-rouge">owner</code> has approved a <code class="language-plaintext highlighter-rouge">spender</code> to transfer an <code class="language-plaintext highlighter-rouge">amount</code> of a token <code class="language-plaintext highlighter-rouge">id</code> to be transferred on the owner’s behalf.</p>

<p>MUST be logged when the <code class="language-plaintext highlighter-rouge">allowance</code> is set by an <code class="language-plaintext highlighter-rouge">owner</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">Approval</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">event</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">owner</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">spender</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">true</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
      <span class="na">indexed</span><span class="pi">:</span> <span class="no">false</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h3 id="interface-id">Interface ID</h3>

<p>The interface ID is <code class="language-plaintext highlighter-rouge">0x0f632fb3</code>.</p>

<h3 id="metadata-extension">Metadata Extension</h3>

<h4 id="methods-1">Methods</h4>

<h5 id="name">name</h5>

<p>The <code class="language-plaintext highlighter-rouge">name</code> of the contract.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">name</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">name</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
</code></pre></div></div>

<h5 id="symbol">symbol</h5>

<p>The ticker <code class="language-plaintext highlighter-rouge">symbol</code> of the contract.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">symbol</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">symbol</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
</code></pre></div></div>

<h5 id="decimals">decimals</h5>

<p>The <code class="language-plaintext highlighter-rouge">amount</code> of decimals for a token <code class="language-plaintext highlighter-rouge">id</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">decimals</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
  <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">amount</span>
    <span class="na">type</span><span class="pi">:</span> <span class="s">uint8</span>
</code></pre></div></div>

<h3 id="content-uri-extension">Content URI Extension</h3>

<h4 id="methods-2">Methods</h4>

<h5 id="contracturi">contractURI</h5>

<p>The <code class="language-plaintext highlighter-rouge">URI</code> for a token <code class="language-plaintext highlighter-rouge">id</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">contractURI</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span> <span class="pi">[]</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">uri</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
</code></pre></div></div>

<h5 id="tokenuri">tokenURI</h5>

<p>The <code class="language-plaintext highlighter-rouge">URI</code> for a token <code class="language-plaintext highlighter-rouge">id</code>.</p>

<p>MAY revert if the token <code class="language-plaintext highlighter-rouge">id</code> does not exist.</p>

<p>MUST replace occurrences of <code class="language-plaintext highlighter-rouge">{id}</code> in the returned URI string by the client.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">tokenURI</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">uri</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">string</span>
</code></pre></div></div>

<h4 id="metadata-structure">Metadata Structure</h4>

<h5 id="contract-uri">Contract URI</h5>

<p>JSON Schema:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Contract Metadata"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The name of the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The description of the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"image_url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The URL of the image representing the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"banner_image_url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The URL of the banner image of the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"external_link"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"format"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uri"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"The external link of the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"editors"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"array"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"items"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
        </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
        </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An Ethereum address representing an authorized editor of the contract."</span><span class="w">
      </span><span class="p">},</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An array of Ethereum addresses representing editors (authorized editors) of the contract."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"animation_url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An animation URL for the contract."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"name"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>JSON Example (Minimal):</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Contract Name"</span><span class="p">,</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h5 id="token-uri">Token URI</h5>

<p>MUST replace occurrences of <code class="language-plaintext highlighter-rouge">{id}</code> in the returned URI string by the client.</p>

<p>JSON Schema:</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"title"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Asset Metadata"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"object"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"properties"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Identifies the token"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Describes the token"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"image"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"A URI pointing to an image resource."</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="nl">"animation_url"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="nl">"type"</span><span class="p">:</span><span class="w"> </span><span class="s2">"string"</span><span class="p">,</span><span class="w">
      </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"An animation URL for the token."</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="nl">"required"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w"> </span><span class="s2">"image"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>JSON Example (Minimal):</p>

<div class="language-json highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">{</span><span class="w">
  </span><span class="nl">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Token Name"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Example Token Description"</span><span class="p">,</span><span class="w">
  </span><span class="nl">"image"</span><span class="p">:</span><span class="w"> </span><span class="s2">"exampleurl/{id}"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h3 id="token-supply-extension">Token Supply Extension</h3>

<h4 id="methods-3">Methods</h4>

<h5 id="totalsupply">totalSupply</h5>

<p>The <code class="language-plaintext highlighter-rouge">totalSupply</code> for a token <code class="language-plaintext highlighter-rouge">id</code>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">totalSupply</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">id</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">supply</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h2 id="rationale">Rationale</h2>

<h3 id="granular-approvals">Granular Approvals</h3>

<p>While the “operator model” from the ERC-1155 standard allows an account to set another account as an operator, giving full permissions to transfer any amount of any token id on behalf of the owner, this may not always be the desired permission scheme. The “allowance model” from <a href="./eip-20.md">ERC-20</a> allows an account to set an explicit amount of the token that another account can spend on the owner’s behalf. This standard requires both be implemented, with the only modification being to the “allowance model” where the token id must be specified as well. This allows an account to grant specific approvals to specific token ids, infinite approvals to specific token ids, or infinite approvals to all token ids. If an account is set as an operator, the allowance SHOULD NOT be decreased when tokens are transferred on behalf of the owner.</p>

<h3 id="removal-of-batching">Removal of Batching</h3>

<p>While batching operations is useful, its place should not be in the standard itself, but rather on a case-by-case basis. This allows for different tradeoffs to be made in terms of calldata layout, which may be especially useful for specific applications such as roll-ups that commit calldata to global storage.</p>

<h3 id="removal-of-required-callbacks">Removal of Required Callbacks</h3>

<p>Callbacks MAY be used within a multi-token compliant contract, but it is not required. This allows for more gas efficient methods by reducing external calls and additional checks.</p>

<h3 id="removal-of-safe-naming">Removal of “Safe” Naming</h3>

<p>The <code class="language-plaintext highlighter-rouge">safeTransfer</code> and <code class="language-plaintext highlighter-rouge">safeTransferFrom</code> naming conventions are misleading, especially in the context of the ERC-1155 and ERC-721 standards, as they require external calls to receiver accounts with code, passing the execution flow to an arbitrary contract, provided the receiver contract returns a specific value. The combination of removing mandatory callbacks and removing the word “safe” from all method names improves the safety of the control flow by default.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>This is not backwards compatible with ERC-1155 as some methods are removed. However, wrappers can be implemented for the ERC-20, ERC-721, and ERC-1155 standards.</p>

<h2 id="reference-implementation">Reference Implementation</h2>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// SPDX-License-Identifier: CC0-1.0
</span><span class="k">pragma</span> <span class="n">solidity</span> <span class="mf">0.8</span><span class="p">.</span><span class="mi">19</span><span class="p">;</span>

<span class="c1">/// @title ERC6909 Multi-Token Reference Implementation
/// @author jtriley.eth
</span><span class="k">contract</span> <span class="n">ERC6909</span> <span class="p">{</span>
    <span class="c1">/// @dev Thrown when owner balance for id is insufficient.
</span>    <span class="c1">/// @param owner The address of the owner.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="n">error</span> <span class="n">InsufficientBalance</span><span class="p">(</span><span class="kt">address</span> <span class="n">owner</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">);</span>

    <span class="c1">/// @dev Thrown when spender allowance for id is insufficient.
</span>    <span class="c1">/// @param spender The address of the spender.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="n">error</span> <span class="n">InsufficientPermission</span><span class="p">(</span><span class="kt">address</span> <span class="n">spender</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">);</span>

    <span class="c1">/// @notice The event emitted when a transfer occurs.
</span>    <span class="c1">/// @param sender The address of the sender.
</span>    <span class="c1">/// @param receiver The address of the receiver.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="c1">/// @param amount The amount of the token.
</span>    <span class="k">event</span> <span class="n">Transfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">caller</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">);</span>

    <span class="c1">/// @notice The event emitted when an operator is set.
</span>    <span class="c1">/// @param owner The address of the owner.
</span>    <span class="c1">/// @param spender The address of the spender.
</span>    <span class="c1">/// @param approved The approval status.
</span>    <span class="k">event</span> <span class="n">OperatorSet</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">owner</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">spender</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">approved</span><span class="p">);</span>

    <span class="c1">/// @notice The event emitted when an approval occurs.
</span>    <span class="c1">/// @param owner The address of the owner.
</span>    <span class="c1">/// @param spender The address of the spender.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="c1">/// @param amount The amount of the token.
</span>    <span class="k">event</span> <span class="n">Approval</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">owner</span><span class="p">,</span> <span class="kt">address</span> <span class="k">indexed</span> <span class="n">spender</span><span class="p">,</span> <span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">);</span>

    <span class="c1">/// @notice Owner balance of an id.
</span>    <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="n">owner</span> <span class="o">=&gt;</span> <span class="k">mapping</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">id</span> <span class="o">=&gt;</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">))</span> <span class="k">public</span> <span class="n">balanceOf</span><span class="p">;</span>

    <span class="c1">/// @notice Spender allowance of an id.
</span>    <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="n">owner</span> <span class="o">=&gt;</span> <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="n">spender</span> <span class="o">=&gt;</span> <span class="k">mapping</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">id</span> <span class="o">=&gt;</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)))</span> <span class="k">public</span> <span class="n">allowance</span><span class="p">;</span>

    <span class="c1">/// @notice Checks if a spender is approved by an owner as an operator.
</span>    <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="n">owner</span> <span class="o">=&gt;</span> <span class="k">mapping</span><span class="p">(</span><span class="kt">address</span> <span class="n">spender</span> <span class="o">=&gt;</span> <span class="kt">bool</span><span class="p">))</span> <span class="k">public</span> <span class="n">isOperator</span><span class="p">;</span>

    <span class="c1">/// @notice Transfers an amount of an id from the caller to a receiver.
</span>    <span class="c1">/// @param receiver The address of the receiver.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="c1">/// @param amount The amount of the token.
</span>    <span class="k">function</span> <span class="nb">transfer</span><span class="p">(</span><span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">public</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">balanceOf</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">)</span> <span class="nb">revert</span> <span class="n">InsufficientBalance</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
        <span class="n">balanceOf</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
        <span class="n">balanceOf</span><span class="p">[</span><span class="n">receiver</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
        <span class="k">emit</span> <span class="n">Transfer</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Transfers an amount of an id from a sender to a receiver.
</span>    <span class="c1">/// @param sender The address of the sender.
</span>    <span class="c1">/// @param receiver The address of the receiver.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="c1">/// @param amount The amount of the token.
</span>    <span class="k">function</span> <span class="n">transferFrom</span><span class="p">(</span><span class="kt">address</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">public</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">sender</span> <span class="o">!=</span> <span class="n">msg</span><span class="p">.</span><span class="n">sender</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">isOperator</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">])</span> <span class="p">{</span>
            <span class="kt">uint256</span> <span class="n">senderAllowance</span> <span class="o">=</span> <span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">];</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">senderAllowance</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">)</span> <span class="nb">revert</span> <span class="n">InsufficientPermission</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">senderAllowance</span> <span class="o">!=</span> <span class="k">type</span><span class="p">(</span><span class="kt">uint256</span><span class="p">).</span><span class="n">max</span><span class="p">)</span> <span class="p">{</span>
                <span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">senderAllowance</span> <span class="o">-</span> <span class="n">amount</span><span class="p">;</span>
            <span class="p">}</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">balanceOf</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">)</span> <span class="nb">revert</span> <span class="n">InsufficientBalance</span><span class="p">(</span><span class="n">sender</span><span class="p">,</span> <span class="n">id</span><span class="p">);</span>
        <span class="n">balanceOf</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
        <span class="n">balanceOf</span><span class="p">[</span><span class="n">receiver</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
        <span class="k">emit</span> <span class="n">Transfer</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Approves an amount of an id to a spender.
</span>    <span class="c1">/// @param spender The address of the spender.
</span>    <span class="c1">/// @param id The id of the token.
</span>    <span class="c1">/// @param amount The amount of the token.
</span>    <span class="k">function</span> <span class="n">approve</span><span class="p">(</span><span class="kt">address</span> <span class="n">spender</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">public</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">allowance</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">spender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">=</span> <span class="n">amount</span><span class="p">;</span>
        <span class="k">emit</span> <span class="n">Approval</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">spender</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>


    <span class="c1">/// @notice Sets or removes a spender as an operator for the caller.
</span>    <span class="c1">/// @param spender The address of the spender.
</span>    <span class="c1">/// @param approved The approval status.
</span>    <span class="k">function</span> <span class="n">setOperator</span><span class="p">(</span><span class="kt">address</span> <span class="n">spender</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">approved</span><span class="p">)</span> <span class="k">public</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">isOperator</span><span class="p">[</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">spender</span><span class="p">]</span> <span class="o">=</span> <span class="n">approved</span><span class="p">;</span>
        <span class="k">emit</span> <span class="n">OperatorSet</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">spender</span><span class="p">,</span> <span class="n">approved</span><span class="p">);</span>
        <span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">/// @notice Checks if a contract implements an interface.
</span>    <span class="c1">/// @param interfaceId The interface identifier, as specified in ERC-165.
</span>    <span class="c1">/// @return supported True if the contract implements `interfaceId`.
</span>    <span class="k">function</span> <span class="n">supportsInterface</span><span class="p">(</span><span class="kt">bytes4</span> <span class="n">interfaceId</span><span class="p">)</span> <span class="k">public</span> <span class="k">pure</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span> <span class="n">supported</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">interfaceId</span> <span class="o">==</span> <span class="mh">0x0f632fb3</span> <span class="o">||</span> <span class="n">interfaceId</span> <span class="o">==</span> <span class="mh">0x01ffc9a7</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="n">_mint</span><span class="p">(</span><span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">internal</span> <span class="p">{</span>
      <span class="c1">// WARNING: important safety checks should precede calls to this method.
</span>      <span class="n">balanceOf</span><span class="p">[</span><span class="n">receiver</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">+=</span> <span class="n">amount</span><span class="p">;</span>
      <span class="k">emit</span> <span class="n">Transfer</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">receiver</span><span class="p">,</span> <span class="n">id</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="k">function</span> <span class="n">_burn</span><span class="p">(</span><span class="kt">address</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">internal</span> <span class="p">{</span>
      <span class="c1">// WARNING: important safety checks should precede calls to this method.
</span>      <span class="n">balanceOf</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
      <span class="k">emit</span> <span class="n">Transfer</span><span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">,</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="n">id</span><span class="p">,</span> <span class="n">amount</span><span class="p">);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="security-considerations">Security Considerations</h2>

<h3 id="approvals-and-operators">Approvals and Operators</h3>

<p>The specification includes two token transfer permission systems, the “allowance” and “operator”
models. There are two security considerations in regards to delegating permission to transfer.</p>

<p>The first consideration is consistent with all delegated permission models. Any account with an allowance may transfer the full allowance for any reason at any time until the allowance is revoked. Any account with operator permissions may transfer any amount of any token id on behalf of the owner until the operator permission is revoked.</p>

<p>The second consideration is unique to systems with both delegated permission models. In accordance with the <code class="language-plaintext highlighter-rouge">transferFrom</code> method, spenders with operator permission are not subject to allowance restrictions, spenders with infinite approvals SHOULD NOT have their allowance deducted on delegated transfers, but spenders with non-infinite approvals MUST have their balance deducted on delegated transfers. A spender with both operator permission and a non-infinite approval may introduce functional ambiguity. If the operator permission takes precedence, that is, the allowance is never deducted when a spender has operator permissions, there is no ambiguity. However, in the event the allowance takes precedence over the operator permissions, an additional branch may be necessary to ensure an allowance underflow does not occur. The following is an example of such an issue.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">contract</span> <span class="n">ERC6909OperatorPrecedence</span> <span class="p">{</span>
  <span class="c1">// -- snip --
</span>
  <span class="k">function</span> <span class="n">transferFrom</span><span class="p">(</span><span class="kt">address</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">public</span> <span class="p">{</span>
    <span class="c1">// check if `isOperator` first
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span> <span class="o">!=</span> <span class="n">sender</span> <span class="o">&amp;&amp;</span> <span class="o">!</span><span class="n">isOperator</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">])</span> <span class="p">{</span>
      <span class="nb">require</span><span class="p">(</span><span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">amount</span><span class="p">,</span> <span class="s">"insufficient allowance"</span><span class="p">);</span>
      <span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>
    <span class="p">}</span>
  
    <span class="c1">// -- snip --
</span>  <span class="p">}</span>
<span class="p">}</span>

<span class="k">contract</span> <span class="n">ERC6909AllowancePrecedence</span> <span class="p">{</span>
  <span class="c1">// -- snip --
</span>
  <span class="k">function</span> <span class="n">transferFrom</span><span class="p">(</span><span class="kt">address</span> <span class="n">sender</span><span class="p">,</span> <span class="kt">address</span> <span class="n">receiver</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">id</span><span class="p">,</span> <span class="kt">uint256</span> <span class="n">amount</span><span class="p">)</span> <span class="k">public</span> <span class="p">{</span>
    <span class="c1">// check if allowance is sufficient first
</span>    <span class="k">if</span> <span class="p">(</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span> <span class="o">!=</span> <span class="n">sender</span> <span class="o">&amp;&amp;</span> <span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">amount</span><span class="p">)</span> <span class="p">{</span>
      <span class="nb">require</span><span class="p">(</span><span class="n">isOperator</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">],</span> <span class="s">"insufficient allowance"</span><span class="p">);</span>
    <span class="p">}</span>

    <span class="c1">// ERROR: when allowance is insufficient, this panics due to arithmetic underflow, regardless of
</span>    <span class="c1">// whether the caller has operator permissions.
</span>    <span class="n">allowance</span><span class="p">[</span><span class="n">sender</span><span class="p">][</span><span class="n">msg</span><span class="p">.</span><span class="n">sender</span><span class="p">][</span><span class="n">id</span><span class="p">]</span> <span class="o">-=</span> <span class="n">amount</span><span class="p">;</span>

    <span class="c1">// -- snip
</span>  <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
