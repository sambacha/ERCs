<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Efficient Default Lockable Tokens | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Efficient Default Lockable Tokens | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-6982" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-6982" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Efficient Default Lockable Tokens</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>This proposal introduces a lockable interface for <a href="./eip-721.md">ERC-721</a> tokens that optimizes gas usage by eliminating unnecessary events. This interface forms the foundation for the creation and management of lockable <a href="./eip-721.md">ERC-721</a> tokens. It provides a gas-efficient approach by emitting a <code class="language-plaintext highlighter-rouge">DefaultLocked(bool locked)</code> event upon deployment, setting the initial lock status for all tokens, while individual <code class="language-plaintext highlighter-rouge">Locked(uint256 indexed tokenId, bool locked)</code> events handle subsequent status changes for specific tokens. The interface also includes a view function <code class="language-plaintext highlighter-rouge">locked(uint256 tokenId)</code> to return the current lock status of a token, and a view function <code class="language-plaintext highlighter-rouge">defaultLocked()</code> to query the default status of a newly minted token.</p>

<h2 id="motivation">Motivation</h2>

<p>Existing lockable token proposals often mandate the emission of an event each time a token is minted. This results in unnecessary gas consumption, especially in cases where tokens are permanently locked from inception to destruction (e.g., soulbounds or non-transferable badges). This proposal offers a more gas-efficient solution that only emits events upon contract deployment and status changes of individual tokens.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119 and RFC 8174.</p>

<p>The interface is defined as follows:</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// ERC165 interfaceId 0x6b61a747
</span><span class="k">interface</span> <span class="n">IERC6982</span> <span class="p">{</span>
  <span class="cm">/**
   * @dev MUST be emitted when the contract is deployed to establish the default lock status 
   *      for all tokens. Also, MUST be emitted again if the default lock status changes, 
   *      to ensure the default status for all tokens (without a specific `Locked` event) is updated.
   */</span>
  <span class="k">event</span> <span class="n">DefaultLocked</span><span class="p">(</span><span class="kt">bool</span> <span class="n">locked</span><span class="p">);</span>

  <span class="cm">/**
   * @dev MUST be emitted when the lock status of a specific token changes.
   *      This status overrides the default lock status for that specific token.
   */</span>
  <span class="k">event</span> <span class="n">Locked</span><span class="p">(</span><span class="kt">uint256</span> <span class="k">indexed</span> <span class="n">tokenId</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">locked</span><span class="p">);</span>

  <span class="cm">/**
   * @dev Returns the current default lock status for tokens. 
   *      The returned value MUST reflect the status indicated by the most recent `DefaultLocked` event.
   */</span>
  <span class="k">function</span> <span class="n">defaultLocked</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

  <span class="cm">/**
   * @dev Returns the lock status of a specific token. 
   *      If no `Locked` event has been emitted for the token, it MUST return the current default lock status. 
   *      The function MUST revert if the token does not exist.
   */</span>
  <span class="k">function</span> <span class="n">locked</span><span class="p">(</span><span class="kt">uint256</span> <span class="n">tokenId</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The <a href="./eip-165.md">ERC-165</a> interfaceId is <code class="language-plaintext highlighter-rouge">0x6b61a747</code>.</p>

<h2 id="rationale">Rationale</h2>

<p>This standard seeks to optimize gas consumption by minimizing the frequency of event emission. The <code class="language-plaintext highlighter-rouge">DefaultLocked</code> event is designed to establish the lock status for all tokens, thereby circumventing the need to emit an event each time a new token is minted. It’s crucial to note that the <code class="language-plaintext highlighter-rouge">DefaultLocked</code> event can be emitted at any point in time, and is not restricted to only before the <code class="language-plaintext highlighter-rouge">Locked</code> events are emitted.</p>

<p>Tokens may alter their behavior under certain circumstances (such as after a reveal), prompting the re-emission of the <code class="language-plaintext highlighter-rouge">DefaultLocked</code> event to reflect the new default status. The primary objective here is to economize on gas usage by avoiding the need to emit a <code class="language-plaintext highlighter-rouge">Locked</code> event for each token when the default status changes.</p>

<p>The <code class="language-plaintext highlighter-rouge">Locked</code> event is utilized to document changes in the lock status of individual tokens.</p>

<p>The <code class="language-plaintext highlighter-rouge">defaultLocked</code> function returns the prevailing default lock status of a token. This function is beneficial as it fosters interaction with other contracts and averts potential conflicts with <a href="./eip-5192">ERC-5192</a>, which is in its final stage.</p>

<p>The <code class="language-plaintext highlighter-rouge">locked</code> function gives the current lock status of a particular token, further facilitating interaction with other contracts. If no changes have been made to a specific token ID, this function should return the value provided by the <code class="language-plaintext highlighter-rouge">defaultLocked</code> function.</p>

<p>Bear in mind that a token being designated as “locked” doesn’t necessarily imply that it is entirely non-transferable. There might be certain conditions under which a token can still be transferred despite its locked status. Primarily, the locked status relates to a token’s transferability on marketplaces and external exchanges.</p>

<p>To illustrate, let’s consider the Cruna protocol. In this system, an NFT owner has the ability to activate what is termed an ‘protector’. This is essentially a secondary wallet with the unique privilege of initiating key transactions. Upon setting an initiator, the token’s status is rendered ‘locked’. However, this does not impede the token’s transferability if the initiation for the transfer comes from the designated protector.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>This standard is fully backwards compatible with existing <a href="./eip-721.md">ERC-721</a> contracts. It can be easily integrated into existing contracts and will not cause any conflicts or disruptions.</p>

<h2 id="reference-implementation">Reference Implementation</h2>

<p>An example implementation is located in the <a href="../assets/eip-6982">assets</a> directory.</p>

<p>It solves a specific use case: token’s owners losing the ownership when staking the asset in a pool. The implementation allow the pool to lock the asset, leaving the ownership to the owner. In the <a href="../assets/eip-6982/README.md">README</a> you can find more details about how to compile and test the contracts.</p>

<h2 id="security-considerations">Security Considerations</h2>

<p>This EIP does not introduce any known security considerations. However, as with any smart contract standard, it is crucial to employ rigorous security measures in the implementation of this interface.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
