<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Native Asset ERC-4626 Tokenized Vault | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Native Asset ERC-4626 Tokenized Vault | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-7535" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-7535" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Native Asset ERC-4626 Tokenized Vault</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>This standard is an extension of the <a href="./eip-4626.md">ERC-4626</a> spec with an identical interface and behavioral overrides for handling Ether or any native asset as the underlying.</p>

<h2 id="motivation">Motivation</h2>

<p>A standard for tokenized ETH Vaults has the same benefits as <a href="./eip-4626.md">ERC-4626</a>, particularly in the case of Liquid Staking Tokens, (i.e. fungible <a href="./eip-20.md">ERC-20</a> wrappers around ETH staking).</p>

<p>Maintaining the same exact interface as ERC-4626 further amplifies the benefits as the standard will be maximally compatible with existing ERC-4626 tooling and protocols.</p>

<h2 id="specification">Specification</h2>

<p>All <a href="./eip-7535.md">ERC-7535</a> tokenized Vaults MUST implement ERC-4626 (and by extension ERC-20) with behavioral overrides for the methods <code class="language-plaintext highlighter-rouge">asset</code>, <code class="language-plaintext highlighter-rouge">deposit</code>, and <code class="language-plaintext highlighter-rouge">mint</code> specified below.</p>

<h3 id="erc-4626-breaking-changes">ERC-4626 Breaking Changes</h3>

<ul>
  <li>Any <code class="language-plaintext highlighter-rouge">assets</code> quantity refers to wei of Ether rather than ERC-20 balances.</li>
  <li>Any ERC-20 <code class="language-plaintext highlighter-rouge">transfer</code> calls are replaced by Ether transfer (<code class="language-plaintext highlighter-rouge">send</code> or <code class="language-plaintext highlighter-rouge">call</code>)</li>
  <li>Any ERC-20 <code class="language-plaintext highlighter-rouge">transferFrom</code> approval flows for <code class="language-plaintext highlighter-rouge">asset</code> are not implemented</li>
  <li><code class="language-plaintext highlighter-rouge">deposit</code> and <code class="language-plaintext highlighter-rouge">mint</code> have state mutability <code class="language-plaintext highlighter-rouge">payable</code></li>
  <li><code class="language-plaintext highlighter-rouge">deposit</code> uses <code class="language-plaintext highlighter-rouge">msg.value</code> as the primary input and MAY ignore <code class="language-plaintext highlighter-rouge">assets</code></li>
</ul>

<h3 id="methods">Methods</h3>

<h4 id="asset">asset</h4>

<p>MUST return <code class="language-plaintext highlighter-rouge">0xEeeeeEeeeEeEeeEeEeEeeEEEeeeeEeeeeeeeEEeE</code> per <a href="./eip-7528.md">ERC-7528</a>.</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">asset</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">view</span>

  <span class="na">inputs</span><span class="pi">:</span> <span class="pi">[]</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">assetTokenAddress</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>
</code></pre></div></div>

<h4 id="deposit">deposit</h4>

<p>Mints <code class="language-plaintext highlighter-rouge">shares</code> Vault shares to <code class="language-plaintext highlighter-rouge">receiver</code> by depositing exactly <code class="language-plaintext highlighter-rouge">msg.value</code> of Ether.</p>

<p>MUST have state mutability of <code class="language-plaintext highlighter-rouge">payable</code>.</p>

<p>MUST use <code class="language-plaintext highlighter-rouge">msg.value</code> as the primary input parameter for calculating the <code class="language-plaintext highlighter-rouge">shares</code> output. I.e. MAY ignore <code class="language-plaintext highlighter-rouge">assets</code> parameter as an input.</p>

<p>MUST emit the <code class="language-plaintext highlighter-rouge">Deposit</code> event.</p>

<p>MUST revert if all of <code class="language-plaintext highlighter-rouge">msg.value</code> cannot be deposited (due to deposit limit being reached, slippage, etc).</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">deposit</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">payable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">assets</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">receiver</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">shares</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h4 id="mint">mint</h4>

<p>Mints exactly <code class="language-plaintext highlighter-rouge">shares</code> Vault shares to <code class="language-plaintext highlighter-rouge">receiver</code> by depositing <code class="language-plaintext highlighter-rouge">assets</code> of ETH.</p>

<p>MUST have state mutability of <code class="language-plaintext highlighter-rouge">payable</code>.</p>

<p>MUST emit the <code class="language-plaintext highlighter-rouge">Deposit</code> event.</p>

<p>MUST revert if all of <code class="language-plaintext highlighter-rouge">shares</code> cannot be minted (due to deposit limit being reached, slippage, the user not sending a large enough <code class="language-plaintext highlighter-rouge">msg.value</code> of Ether to the Vault contract, etc).</p>

<div class="language-yaml highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">mint</span>
  <span class="na">type</span><span class="pi">:</span> <span class="s">function</span>
  <span class="na">stateMutability</span><span class="pi">:</span> <span class="s">payable</span>

  <span class="na">inputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">shares</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">receiver</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">address</span>

  <span class="na">outputs</span><span class="pi">:</span>
    <span class="pi">-</span> <span class="na">name</span><span class="pi">:</span> <span class="s">assets</span>
      <span class="na">type</span><span class="pi">:</span> <span class="s">uint256</span>
</code></pre></div></div>

<h3 id="events">Events</h3>

<p>The event usage MUST be identical to ERC-4626.</p>

<h3 id="wrapped-eth">Wrapped ETH</h3>

<p>Any ERC-4626 Vault that uses a Wrapped ETH ERC-20 as the <code class="language-plaintext highlighter-rouge">asset</code> MUST NOT implement ERC-7535. ERC-7535 only applies to native ETH.</p>

<h2 id="rationale">Rationale</h2>

<p>This standard was designed to maximize compatibility with ERC-4626 while minimizing additional opinionated details on the interface. Examples of this decision rationale are described below:</p>

<ul>
  <li>maintaining the redundant <code class="language-plaintext highlighter-rouge">assets</code> input to the <code class="language-plaintext highlighter-rouge">deposit</code> function while making its usage optional</li>
  <li>not enforcing a relationship between <code class="language-plaintext highlighter-rouge">msg.value</code> and <code class="language-plaintext highlighter-rouge">assets</code> in a <code class="language-plaintext highlighter-rouge">mint</code> call</li>
  <li>not enforcing any behaviors or lack thereof for <code class="language-plaintext highlighter-rouge">fallback</code>/<code class="language-plaintext highlighter-rouge">__default__</code> methods, payability on additional vault functions, or handling ETH forcibly sent to the contract</li>
</ul>

<p>All breaking implementation level changes with ERC-4626 are purely to accomodate for the usage of Ether or any native asset instead of an ERC-20 token.</p>

<h3 id="allowing-assets-parameter-to-be-ignored-in-a-deposit">Allowing assets Parameter to be Ignored in a Deposit</h3>
<p><code class="language-plaintext highlighter-rouge">msg.value</code> must always be passed anyway to fund a <code class="language-plaintext highlighter-rouge">deposit</code>, therefore it may as well be treated as the primary input number. Allowing <code class="language-plaintext highlighter-rouge">assets</code> to be used either forces a strict equality and extra unnecessary gas overhead for redundancy, or allows different values which could cause footguns and undefined behavior.</p>

<p>The last option which could work is to require that <code class="language-plaintext highlighter-rouge">assets</code> MUST be 0, but this still requires gas to enforce at the implementation level and can more easily be left unspecified, as the input is functionally ignorable in the spec as written.</p>

<h3 id="allowing-msgvalue-to-not-equal-assets-output-in-a-mint">Allowing msg.value to Not Equal assets Output in a Mint</h3>
<p>There may be many cases where a user deposits slightly too much Ether in a <code class="language-plaintext highlighter-rouge">mint</code> call. In these cases, enforcing <code class="language-plaintext highlighter-rouge">msg.value</code> to equal <code class="language-plaintext highlighter-rouge">assets</code> would cause unnecessary reversions. It is up to the vault implementer to decide whether to refund or absorb any excess Ether, and up to depositors to deposit as close to the exact amount as possible.</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>ERC-7535 is fully backward compatible with ERC-4626 at the function interface level. Certain implementation behaviors are different due to the fact that ETH is not ERC-20 compliant, such as the priority of <code class="language-plaintext highlighter-rouge">msg.value</code> over <code class="language-plaintext highlighter-rouge">assets</code>.</p>

<p>It has no known compatibility issues with other standards.</p>

<h2 id="security-considerations">Security Considerations</h2>

<p>In addition to all security considerations of <a href="./eip-4626.md">ERC-4626</a>, there are security implications of having ETH as the Vault asset.</p>

<h3 id="call-vs-send"><code class="language-plaintext highlighter-rouge">call</code> vs <code class="language-plaintext highlighter-rouge">send</code></h3>

<p>Contracts should take care when using <code class="language-plaintext highlighter-rouge">call</code> to transfer ETH, as this allows additional reentrancy vulnerabilities and arbitrary code execution beyond what is possible with trusted ERC-20 tokens.</p>

<p>It is safer to simply <code class="language-plaintext highlighter-rouge">send</code> ETH with a small gas stipend.</p>

<p>Implementers should take extra precautions when deciding how to transfer ETH.</p>

<h3 id="forceful-eth-transfers">Forceful ETH transfers</h3>

<p>ETH can be forced into any Vault through the <code class="language-plaintext highlighter-rouge">SELFDESTRUCT</code> opcode. Implementers should validate that this does not disrupt Vault accounting in any way.</p>

<p>Similarly, any additional <code class="language-plaintext highlighter-rouge">payable</code> methods should be checked to ensure they do not disrupt Vault accounting.</p>

<h3 id="wrapped-eth-1">Wrapped ETH</h3>

<p>Smart contract systems which implement ERC-4626 should consider only supporting ERC-20 underlying assets, and default to using a Wrapped ETH ERC-20 instead of implementing ERC-7535 for handling ETH.</p>

<p>The subtle differences between ERC-4626 and ERC-7535 can introduce code fragmentation and security concerns.</p>

<p>Cleaner use cases for ERC-7535 are ETH exclusive, such as Wrapped ETH and Liquid Staking Tokens.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
