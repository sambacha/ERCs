<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  
  <title>Dual Nature Token Pair | Ethereum Improvement Proposals</title>
    <meta
      property="og:title"
      content="Dual Nature Token Pair | Ethereum Improvement Proposals"
    />
    <meta name="description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta property="og:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
    <meta name="twitter:description" content="Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards." />
  
  <meta name="generator" content="Jekyll" />
  <meta property="og:locale" content="en_US" />
  <link rel="canonical" href="http://localhost:4000/ERCS/erc-7631" />
  <meta property="og:url" content="http://localhost:4000/ERCS/erc-7631" />
  <meta property="og:site_name" content="Ethereum Improvement Proposals" />
  <meta name="twitter:card" content="summary" />
  <meta name="twitter:site" content="@" />
  <script type="application/ld+json">
    {
      "@type": "WebSite",
      "url": "http://localhost:4000",
      "name": "Ethereum Improvement Proposals",
      "description": "Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.",
      "@context": "https://schema.org"
    }
  </script>
  <link rel="stylesheet" href="/assets/css/style.css" /><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Ethereum Improvement Proposals" /><link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
  <link rel="stylesheet" href="/assets/css/override.css" />
  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz9ATKxIep9tiCxS/Z9fNfEXiDAYTujMAeBAsjFuCZSmKbSSUnQlmh/jp3" crossorigin="anonymous"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.min.js" integrity="sha384-Rx+T1VzGupg4BHQYs2gCW9It+akI2MM/mndMCy36UVfodzcJcF0GGLxZIzObiEfa" crossorigin="anonymous"></script>
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", (event) => {
      const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
      const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    });
  </script>
  <script type="text/javascript">
    window.MathJax = {
      loader: {
        load: ['input/tex-base', 'output/chtml']
      },
      tex: {
        inlineMath: [['$', '$']],
        displayMath: [['$$', '$$']],
        processEscapes: true,
        processEnvironments: false,
        processRefs: false
      }
    };
  </script>
  <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js" integrity="sha384-/1zmJ1mBdfKIOnwPxpdG6yaRrxP6qu3eVYm0cz2nOx+AcL4d3AqEFrwcqGZVVroG" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/citation-js/0.6.7/citation.min.js" integrity="sha512-N+LDFMa9owHXGS+CyMrBvuxq2QuGl3fiB/7cys3aUEL7K6P1soHGqsS0sjHXZpwNd9Kz0m3R4IPy1HYRi6ROEQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script type="text/javascript">
    addEventListener('DOMContentLoaded', async () => {
      const Cite = window.require('citation-js');
      const citationElements = document.querySelectorAll('.language-csl-json');
      for (let citationElement of citationElements) {
        try {
          const citation = await Cite.async(citationElement);
          const template = document.createElement('template');
          template.innerHTML = citation.format('bibliography', {
            format: 'html',
            template: 'apa',
            lang: 'en-US'
          });
          if (citationElement.parentElement && citationElement.parentElement.matches('pre')) {
            citationElement.parentElement.replaceWith(template.content);
          } else {
            citationElement.replaceWith(template.content);
          }
        } catch (e) {
          console.error("unable to render citation", e);
        }
      }
    });
  </script>
</head>
<body><header class="site-header" role="banner">
  <div class="wrapper"><a class="site-title" rel="author" href="/">Ethereum Improvement Proposals</a><nav class="site-nav d-flex">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger row p-2"><a class="page-link col" href="/all">All</a><a class="page-link col" href="/core">Core</a><a class="page-link col" href="/networking">Networking</a><a class="page-link col" href="/interface">Interface</a><a class="page-link col" href="/erc">ERC</a><a class="page-link col" href="/meta">Meta</a><a class="page-link col" href="/informational">Informational</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post">

  <header class="post-header">
    <h1 class="post-title">Dual Nature Token Pair</h1>
  </header>

  <div class="post-content">
    <h2 id="abstract">Abstract</h2>

<p>A fungible <a href="./eip-20.md">ERC-20</a> token contract and non-fungible <a href="./eip-721.md">ERC-721</a> token contract can be interlinked, allowing actions performed on one contract to be reflected on the other. This proposal defines how the relationship between the two token contracts can be queried. It also enables accounts to configure if ERC-721 mints and transfers should be skipped during ERC-20 to ERC-721 synchronization.</p>

<h2 id="motivation">Motivation</h2>

<p>The ERC-20 fungible and ERC-721 non-fungible token standards offer sufficient flexibility for a co-joined, dual nature token pair. Transfers on the ERC-20 token can automatically trigger transfers on the ERC-721 token, and vice-versa. This enables applications such as native ERC-721 fractionalization, wherein purchasing ERC-20 tokens leads to the automatic issuance of ERC-721 tokens, proportional to the ERC-20 holdings.</p>

<p>Dual nature token pairs maintain full compliance with both ERC-20 and ERC-721 token standards. This proposal aims to enhance the functionality of dual nature token pairs.</p>

<p>To facilitate querying the relationship between the tokens, extension interfaces are proposed for the ERC-20 and ERC-721 tokens respectively. This enables various quality of life improvements such as allowing decentralized exchanges and NFT marketplaces to display the relationship between the tokens.</p>

<p>Additionally, users can configure if they want to skip ERC-721 mints and transfers during ERC-20 to ERC-721 synchronization.</p>

<h2 id="specification">Specification</h2>

<p>The key words “MUST”, “MUST NOT”, “REQUIRED”, “SHALL”, “SHALL NOT”, “SHOULD”, “SHOULD NOT”, “RECOMMENDED”, “NOT RECOMMENDED”, “MAY”, and “OPTIONAL” in this document are to be interpreted as described in RFC 2119 and RFC 8174.</p>

<h3 id="overview">Overview</h3>

<p>A dual nature token pair comprises of an ERC-20 contract and an ERC-721 contract.</p>

<p>For convention, the ERC-20 contract is designated as the base contract, and the ERC-721 contract is designated as the mirror contract.</p>

<h3 id="erc-20-extension-interface">ERC-20 Extension Interface</h3>

<p>The ERC-20 contract MUST implement the following interface.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IERC7631Base</span> <span class="p">{</span>
    <span class="c1">/// @dev Returns the address of the mirror ERC-721 contract.
</span>    <span class="c1">///
</span>    <span class="c1">/// This method MAY revert or return the zero address
</span>    <span class="c1">/// to denote that a mirror ERC-721 contract has not been linked.
</span>    <span class="c1">///
</span>    <span class="c1">/// If a non-zero address is returned, the returned address MUST
</span>    <span class="c1">/// implement `IERC7631Mirror` and its `baseERC20()` method MUST
</span>    <span class="c1">/// return the address of this contract.
</span>    <span class="c1">///
</span>    <span class="c1">/// Once a non-zero address has been returned, this method
</span>    <span class="c1">/// MUST NOT revert and the returned value MUST NOT change.
</span>    <span class="k">function</span> <span class="n">mirrorERC721</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>The ERC-20 contract MAY implement the following interface.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IERC7631BaseNFTSkippable</span> <span class="p">{</span>
    <span class="c1">/// @dev Emitted when the skip NFT status of `owner` is changed by
</span>    <span class="c1">/// any mechanism.
</span>    <span class="c1">///
</span>    <span class="c1">/// This initial skip NFT status for `owner` can be dynamically chosen to
</span>    <span class="c1">/// be true or false, but any changes to it MUST emit this event.
</span>    <span class="k">event</span> <span class="n">SkipNFTSet</span><span class="p">(</span><span class="kt">address</span> <span class="k">indexed</span> <span class="n">owner</span><span class="p">,</span> <span class="kt">bool</span> <span class="n">status</span><span class="p">);</span>

    <span class="c1">/// @dev Returns true if ERC-721 mints and transfers to `owner` SHOULD be
</span>    <span class="c1">/// skipped during ERC-20 to ERC-721 synchronization. Otherwise false.
</span>    <span class="c1">/// 
</span>    <span class="c1">/// This method MAY revert
</span>    <span class="c1">/// (e.g. contract not initialized, method not supported).
</span>    <span class="c1">///
</span>    <span class="c1">/// If this method reverts:
</span>    <span class="c1">/// - Interacting code SHOULD interpret `setSkipNFT` functionality as
</span>    <span class="c1">///   unavailable (and hide any functionality to call `setSkipNFT`).
</span>    <span class="c1">/// - The skip NFT status for `owner` SHOULD be interpreted as undefined.
</span>    <span class="c1">///
</span>    <span class="c1">/// Once a true or false value has been returned for a given `owner`,
</span>    <span class="c1">/// this method MUST NOT revert for the given `owner`.
</span>    <span class="k">function</span> <span class="n">getSkipNFT</span><span class="p">(</span><span class="kt">address</span> <span class="n">owner</span><span class="p">)</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">bool</span><span class="p">);</span>

    <span class="c1">/// @dev Sets the caller's skip NFT status.
</span>    <span class="c1">///
</span>    <span class="c1">/// This method MAY revert
</span>    <span class="c1">/// (e.g. insufficient permissions, method not supported).
</span>    <span class="c1">///
</span>    <span class="c1">/// Emits a {SkipNFTSet} event.
</span>    <span class="k">function</span> <span class="n">setSkipNFT</span><span class="p">(</span><span class="kt">bool</span> <span class="n">status</span><span class="p">)</span> <span class="k">external</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></div>

<h3 id="erc-721-extension-interface">ERC-721 Extension Interface</h3>

<p>The ERC-721 contract MUST implement the following interface.</p>

<div class="language-solidity highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">interface</span> <span class="n">IERC7631Mirror</span> <span class="p">{</span>
    <span class="c1">/// @dev Returns the address of the base ERC-20 contract.
</span>    <span class="c1">///
</span>    <span class="c1">/// This method MAY revert or return the zero address
</span>    <span class="c1">/// to denote that a base ERC-20 contract has not been linked.
</span>    <span class="c1">///
</span>    <span class="c1">/// If a non-zero address is returned, the returned address MUST
</span>    <span class="c1">/// implement `IERC7631Base` and its `mirrorERC721()` method MUST
</span>    <span class="c1">/// return the address of this contract.
</span>    <span class="c1">///
</span>    <span class="c1">/// Once a non-zero address has been returned, this method
</span>    <span class="c1">/// MUST NOT revert and the returned value MUST NOT change.
</span>    <span class="k">function</span> <span class="n">baseERC20</span><span class="p">()</span> <span class="k">external</span> <span class="k">view</span> <span class="k">returns</span> <span class="p">(</span><span class="kt">address</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>
<h2 id="rationale">Rationale</h2>

<h3 id="implementation-detection">Implementation Detection</h3>

<p>The <code class="language-plaintext highlighter-rouge">mirrorERC721</code> and <code class="language-plaintext highlighter-rouge">baseERC20</code> methods returning non-zero addresses suffice to signal that the contracts implement the required interfaces. As such, <a href="./eip-165.md">ERC-165</a> is not required.</p>

<p>The <code class="language-plaintext highlighter-rouge">getSkipNFT</code> and <code class="language-plaintext highlighter-rouge">setSkipNFT</code> methods MAY revert. As contracts compiled with Solidity or Vyper inherently revert on calls to undefined methods, a typical <code class="language-plaintext highlighter-rouge">IERC7631Base</code> implementation lacking explicit <code class="language-plaintext highlighter-rouge">getSkipNFT</code> and <code class="language-plaintext highlighter-rouge">setSkipNFT</code> definitions still complies with <code class="language-plaintext highlighter-rouge">IERC7631BaseNFTSkippable</code>.</p>

<h3 id="nft-skipping">NFT Skipping</h3>

<p>A useful pattern is to make <code class="language-plaintext highlighter-rouge">getSkipNFT</code> return true by default if <code class="language-plaintext highlighter-rouge">owner</code> is a smart contract. This allows ERC-20 liquidity pools to avoid having ERC-721 tokens automatically minted to it by default whenever there is an ERC-20 transfer.</p>

<p>The choice of <code class="language-plaintext highlighter-rouge">getSkipNFT</code> returning a boolean value is for simplicity. If more complex behavior is needed, developers may add in extra methods of their own.</p>

<h3 id="implementation-conventions">Implementation Conventions</h3>

<p>The ERC-20 contract is designated as the base contract for convention, as a typical implementation can conveniently derive ERC-721 balances from the ERC-20 balances. This does not prohibit one from implementing most of the logic in the ERC-721 contract if required.</p>

<p>This proposal does not cover the token synchronization logic. This is to leave flexibility for various implementation patterns and novel use cases (e.g. automatically rebased tokens).</p>

<h3 id="linking-mechanism">Linking Mechanism</h3>

<p>The linking process omitted for flexibility purposes. Developers can use any desired mechanism (e.g. linking in constructor, initializer, or via custom admin-only public methods on the two contracts). The only restriction is that the pairing must be immutable once established (to simplify indexing logic).</p>

<h2 id="backwards-compatibility">Backwards Compatibility</h2>

<p>No backward compatibility issues found.</p>

<h2 id="security-considerations">Security Considerations</h2>

<h3 id="synchronization-access-guards">Synchronization Access Guards</h3>

<p>External methods for synchronization logic must be guarded such that only the other contract is authorized to call them.</p>

<h3 id="rare-nft-sniping">Rare NFT Sniping</h3>

<p>For dual nature collections that offer ERC-721 tokens with differing rarity levels, the ERC-721 metadata should be revealed in a way that is not easily gameable with metadata scraping and ERC-20 token transfers. A recommendation is to require that an ERC-721 token is held by the same account for some time before revealing its metadata.</p>

<h3 id="out-of-gas-denial-of-service">Out-of-gas Denial of Service</h3>

<p>ERC-20 transfers can automatically trigger multiple ERC-721 tokens to be minted, transferred or burned. This can incur O(n) gas costs instead of the typical O(1) gas costs for ERC-20 tokens transfers. Logic for selecting ERC-721 token IDs can also incur additional gas costs. Synchronization logic must consider ERC-721 related gas costs to prevent out-of-gas denial of service issues.</p>

<h2 id="copyright">Copyright</h2>

<p>Copyright and related rights waived via <a href="/LICENSE">CC0</a>.</p>

  </div>

</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Ethereum Improvement Proposals</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Ethereum Improvement Proposals</li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"><li><a href="https://github.com/ethereum/EIPs"><svg class="svg-icon"><use xlink:href="/assets/minima-social-icons.svg#github"></use></svg> <span class="username">ethereum/EIPs</span></a></li></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Ethereum Improvement Proposals (EIPs) describe standards for the Ethereum platform, including core protocol specifications, client APIs, and contract standards.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
